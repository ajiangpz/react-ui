{"version":3,"file":"Switch.js","sources":["../../../components/hooks/useCommonClassName.ts","../../../components/switch/defaultProps.ts","../../../components/switch/Switch.tsx"],"sourcesContent":["import { useMemo } from 'react';\r\nimport useConfig from './useConfig';\r\n\r\nexport default function useCommonClassName() {\r\n  const { classPrefix } = useConfig();\r\n\r\n  return useMemo(() => {\r\n    const names = {\r\n      SIZE: {\r\n        default: '',\r\n        xs: `${classPrefix}-size-xs`,\r\n        small: `${classPrefix}-size-s`,\r\n        medium: `${classPrefix}-size-m`,\r\n        large: `${classPrefix}-size-l`,\r\n        xl: `${classPrefix}-size-xl`,\r\n        block: `${classPrefix}-size-full-width`,\r\n      },\r\n      STATUS: {\r\n        loading: `${classPrefix}-is-loading`,\r\n        disabled: `${classPrefix}-is-disabled`,\r\n        focused: `${classPrefix}-is-focused`,\r\n        success: `${classPrefix}-is-success`,\r\n        error: `${classPrefix}-is-error`,\r\n        warning: `${classPrefix}-is-warning`,\r\n        selected: `${classPrefix}-is-selected`,\r\n        active: `${classPrefix}-is-active`,\r\n        checked: `${classPrefix}-is-checked`,\r\n        current: `${classPrefix}-is-current`,\r\n        hidden: `${classPrefix}-is-hidden`,\r\n        visible: `${classPrefix}-is-visible`,\r\n        expanded: `${classPrefix}-is-expanded`,\r\n        indeterminate: `${classPrefix}-is-indeterminate`,\r\n      },\r\n    };\r\n    return {\r\n      SIZE: names.SIZE,\r\n      STATUS: names.STATUS,\r\n      sizeClassNames: names.SIZE,\r\n      statusClassNames: names.STATUS,\r\n      classPrefix,\r\n    };\r\n  }, [classPrefix]);\r\n}\r\n\r\nexport type CommonClassNameType = ReturnType<typeof useCommonClassName>;\r\n","\r\nimport { TdSwitchProps } from './type';\r\n\r\nexport const switchDefaultProps: TdSwitchProps = { label: [], loading: false, size: 'medium' };\r\n","import React, { useEffect, useState } from 'react';\r\nimport classNames from 'classnames';\r\nimport Loading from '../loading';\r\nimport useConfig from '../hooks/useConfig';\r\nimport { StyledProps } from '../common';\r\nimport useCommonClassName from '../hooks/useCommonClassName';\r\nimport { SwitchValue, TdSwitchProps } from './type';\r\nimport { switchDefaultProps } from './defaultProps';\r\nimport parseTNode from '../utils/parentTNode';\r\nimport useDefaultProps from '../hooks/useDefaultProps';\r\n\r\nexport type SwitchChangeEventHandler = (value: boolean, event: React.MouseEvent<HTMLButtonElement>) => void;\r\nexport type SwitchClickEventHandler = SwitchChangeEventHandler;\r\n\r\nexport interface SwitchProps<T extends SwitchValue = SwitchValue> extends TdSwitchProps<T>, StyledProps { }\r\n\r\nconst Switch = React.forwardRef<HTMLButtonElement, SwitchProps>((originalProps, ref) => {\r\n  const { classPrefix } = useConfig();\r\n  const props = useDefaultProps<SwitchProps<SwitchValue>>(originalProps, switchDefaultProps);\r\n  const {\r\n    className,\r\n    value,\r\n    defaultValue,\r\n    disabled,\r\n    loading,\r\n    size,\r\n    label,\r\n    customValue,\r\n    onChange,\r\n    beforeChange,\r\n    ...restProps\r\n  } = props;\r\n  const [activeValue = true, inactiveValue = false] = customValue || [];\r\n\r\n  const isControlled = typeof value !== 'undefined';\r\n  const initChecked = defaultValue === activeValue || value === activeValue;\r\n  const [innerChecked, setInnerChecked] = useState(initChecked);\r\n\r\n  const contentNode = React.useMemo<React.ReactNode>(() => {\r\n    if (Array.isArray(label)) {\r\n      const [activeContent = '', inactiveContent = ''] = label;\r\n      const content = innerChecked ? activeContent : inactiveContent;\r\n      return parseTNode(content, { value });\r\n    }\r\n    return parseTNode(label, { value });\r\n  }, [label, innerChecked, value]);\r\n\r\n  const handleChange = (e: React.MouseEvent) => {\r\n    !isControlled && setInnerChecked(!innerChecked);\r\n    const changedValue = !innerChecked ? activeValue : inactiveValue;\r\n    onChange?.(changedValue, { e });\r\n  };\r\n\r\n  const onInternalClick: React.MouseEventHandler<HTMLButtonElement> = (e) => {\r\n    if (disabled) {\r\n      return;\r\n    }\r\n\r\n    if (!beforeChange) {\r\n      handleChange(e);\r\n      return;\r\n    }\r\n    Promise.resolve(beforeChange())\r\n      .then((v) => {\r\n        if (v) {\r\n          handleChange(e);\r\n        }\r\n      })\r\n      .catch((e) => {\r\n        console.error('Switch', `some error occurred: ${e}`);\r\n      });\r\n  };\r\n\r\n  useEffect(() => {\r\n    if (Array.isArray(customValue) && !customValue.includes(value)) {\r\n      console.error('Switch', `value is not in customValue: ${JSON.stringify(customValue)}`);\r\n    }\r\n    isControlled && setInnerChecked(value === activeValue);\r\n  }, [value, customValue, activeValue, isControlled]);\r\n\r\n  const { SIZE, STATUS } = useCommonClassName();\r\n  const switchClassName = classNames(\r\n    `${classPrefix}-switch`,\r\n    className,\r\n    {\r\n      [STATUS.checked]: innerChecked,\r\n      [STATUS.disabled]: disabled,\r\n      [STATUS.loading]: loading,\r\n    },\r\n    SIZE[size],\r\n  );\r\n\r\n  return (\r\n    <button\r\n      {...restProps}\r\n      type=\"button\"\r\n      role=\"switch\"\r\n      disabled={disabled || loading}\r\n      className={switchClassName}\r\n      ref={ref}\r\n      onClick={onInternalClick}\r\n    >\r\n      <span className={`${classPrefix}-switch__handle`}>{loading && <Loading loading size=\"small\" />}</span>\r\n      <div className={`${classPrefix}-switch__content`}>{contentNode}</div>\r\n    </button>\r\n  );\r\n});\r\n\r\nSwitch.displayName = 'Switch';\r\n\r\nexport default Switch as <T extends SwitchValue = SwitchValue>(\r\n  props: SwitchProps<T> & React.RefAttributes<HTMLButtonElement>,\r\n) => React.ReactElement;\r\n"],"names":["useCommonClassName","_useConfig","useConfig","classPrefix","useMemo","names","SIZE","xs","concat","small","medium","large","xl","block","STATUS","loading","disabled","focused","success","error","warning","selected","active","checked","current","hidden","visible","expanded","indeterminate","sizeClassNames","statusClassNames","switchDefaultProps","label","size","Switch","React","forwardRef","originalProps","ref","props","useDefaultProps","className","value","defaultValue","customValue","onChange","beforeChange","restProps","_objectWithoutProperties","_excluded","_ref","_ref2","_slicedToArray","_ref2$","activeValue","_ref2$2","inactiveValue","isControlled","initChecked","_useState","useState","_useState2","innerChecked","setInnerChecked","contentNode","Array","isArray","_label","_label$","activeContent","_label$2","inactiveContent","content","parseTNode","handleChange","e","changedValue","onInternalClick","Promise","resolve","then","v","console","useEffect","includes","JSON","stringify","_useCommonClassName","switchClassName","classNames","_defineProperty","createElement","_extends","type","role","onClick","Loading","displayName"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;AAGe,SAASA,kBAAkBA,GAAG;AAC3C,EAAA,IAAAC,UAAA,GAAwBC,SAAS,EAAE;IAA3BC,WAAW,GAAAF,UAAA,CAAXE,WAAW;EAEnB,OAAOC,OAAO,CAAC,YAAM;AACnB,IAAA,IAAMC,KAAK,GAAG;AACZC,MAAAA,IAAI,EAAE;AACJ,QAAA,SAAA,EAAS,EAAE;AACXC,QAAAA,EAAE,EAAA,EAAA,CAAAC,MAAA,CAAKL,WAAW,EAAA,UAAA,CAAU;AAC5BM,QAAAA,KAAK,EAAA,EAAA,CAAAD,MAAA,CAAKL,WAAW,EAAA,SAAA,CAAS;AAC9BO,QAAAA,MAAM,EAAA,EAAA,CAAAF,MAAA,CAAKL,WAAW,EAAA,SAAA,CAAS;AAC/BQ,QAAAA,KAAK,EAAA,EAAA,CAAAH,MAAA,CAAKL,WAAW,EAAA,SAAA,CAAS;AAC9BS,QAAAA,EAAE,EAAA,EAAA,CAAAJ,MAAA,CAAKL,WAAW,EAAA,UAAA,CAAU;QAC5BU,KAAK,EAAA,EAAA,CAAAL,MAAA,CAAKL,WAAW,EAAA,kBAAA;OACtB;AACDW,MAAAA,MAAM,EAAE;AACNC,QAAAA,OAAO,EAAA,EAAA,CAAAP,MAAA,CAAKL,WAAW,EAAA,aAAA,CAAa;AACpCa,QAAAA,QAAQ,EAAA,EAAA,CAAAR,MAAA,CAAKL,WAAW,EAAA,cAAA,CAAc;AACtCc,QAAAA,OAAO,EAAA,EAAA,CAAAT,MAAA,CAAKL,WAAW,EAAA,aAAA,CAAa;AACpCe,QAAAA,OAAO,EAAA,EAAA,CAAAV,MAAA,CAAKL,WAAW,EAAA,aAAA,CAAa;AACpCgB,QAAAA,KAAK,EAAA,EAAA,CAAAX,MAAA,CAAKL,WAAW,EAAA,WAAA,CAAW;AAChCiB,QAAAA,OAAO,EAAA,EAAA,CAAAZ,MAAA,CAAKL,WAAW,EAAA,aAAA,CAAa;AACpCkB,QAAAA,QAAQ,EAAA,EAAA,CAAAb,MAAA,CAAKL,WAAW,EAAA,cAAA,CAAc;AACtCmB,QAAAA,MAAM,EAAA,EAAA,CAAAd,MAAA,CAAKL,WAAW,EAAA,YAAA,CAAY;AAClCoB,QAAAA,OAAO,EAAA,EAAA,CAAAf,MAAA,CAAKL,WAAW,EAAA,aAAA,CAAa;AACpCqB,QAAAA,OAAO,EAAA,EAAA,CAAAhB,MAAA,CAAKL,WAAW,EAAA,aAAA,CAAa;AACpCsB,QAAAA,MAAM,EAAA,EAAA,CAAAjB,MAAA,CAAKL,WAAW,EAAA,YAAA,CAAY;AAClCuB,QAAAA,OAAO,EAAA,EAAA,CAAAlB,MAAA,CAAKL,WAAW,EAAA,aAAA,CAAa;AACpCwB,QAAAA,QAAQ,EAAA,EAAA,CAAAnB,MAAA,CAAKL,WAAW,EAAA,cAAA,CAAc;QACtCyB,aAAa,EAAA,EAAA,CAAApB,MAAA,CAAKL,WAAW,EAAA,mBAAA;AAC/B;KACD;IACD,OAAO;MACLG,IAAI,EAAED,KAAK,CAACC,IAAI;MAChBQ,MAAM,EAAET,KAAK,CAACS,MAAM;MACpBe,cAAc,EAAExB,KAAK,CAACC,IAAI;MAC1BwB,gBAAgB,EAAEzB,KAAK,CAACS,MAAM;AAC9BX,MAAAA,WAAW,EAAXA;KACD;AACH,EAAA,CAAC,EAAE,CAACA,WAAW,CAAC,CAAC;AACnB;;ACvCO,IAAM4B,kBAAiC,GAAG;AAAEC,EAAAA,KAAK,EAAE,EAAE;AAAEjB,EAAAA,OAAO,EAAE,KAAK;AAAEkB,EAAAA,IAAI,EAAE;AAAS,CAAC;;;ACa9F,IAAMC,MAAM,gBAAGC,KAAK,CAACC,UAAU,CAAiC,UAACC,aAAa,EAAEC,GAAG,EAAK;AACtF,EAAA,IAAArC,UAAA,GAAwBC,SAAS,EAAE;IAA3BC,WAAW,GAAAF,UAAA,CAAXE,WAAW;AACnB,EAAA,IAAMoC,KAAK,GAAGC,eAAe,CAA2BH,aAAa,EAAEN,kBAAkB,CAAC;AAC1F,EAAA,IACEU,SAAS,GAWPF,KAAK,CAXPE,SAAS;IACTC,KAAK,GAUHH,KAAK,CAVPG,KAAK;IACLC,YAAY,GASVJ,KAAK,CATPI,YAAY;IACZ3B,QAAQ,GAQNuB,KAAK,CARPvB,QAAQ;IACRD,OAAO,GAOLwB,KAAK,CAPPxB,OAAO;IACPkB,IAAI,GAMFM,KAAK,CANPN,IAAI;IACJD,KAAK,GAKHO,KAAK,CALPP,KAAK;IACLY,WAAW,GAITL,KAAK,CAJPK,WAAW;IACXC,QAAQ,GAGNN,KAAK,CAHPM,QAAQ;IACRC,YAAY,GAEVP,KAAK,CAFPO,YAAY;AACTC,IAAAA,SAAS,GAAAC,wBAAA,CACVT,KAAK,EAAAU,SAAA,CAAA;AACT,EAAA,IAAAC,IAAA,GAAoDN,WAAW,IAAI,EAAE;IAAAO,KAAA,GAAAC,cAAA,CAAAF,IAAA,EAAA,CAAA,CAAA;AAAAG,IAAAA,MAAA,GAAAF,KAAA,CAAA,CAAA,CAAA;AAA9DG,IAAAA,WAAW,GAAAD,MAAA,KAAA,KAAA,CAAA,GAAG,IAAI,GAAAA,MAAA;AAAAE,IAAAA,OAAA,GAAAJ,KAAA,CAAA,CAAA,CAAA;AAAEK,IAAAA,aAAa,GAAAD,OAAA,KAAA,KAAA,CAAA,GAAG,KAAK,GAAAA,OAAA;AAEhD,EAAA,IAAME,YAAY,GAAG,OAAOf,KAAK,KAAK,WAAW;EACjD,IAAMgB,WAAW,GAAGf,YAAY,KAAKW,WAAW,IAAIZ,KAAK,KAAKY,WAAW;AACzE,EAAA,IAAAK,SAAA,GAAwCC,QAAQ,CAACF,WAAW,CAAC;IAAAG,UAAA,GAAAT,cAAA,CAAAO,SAAA,EAAA,CAAA,CAAA;AAAtDG,IAAAA,YAAY,GAAAD,UAAA,CAAA,CAAA,CAAA;AAAEE,IAAAA,eAAe,GAAAF,UAAA,CAAA,CAAA,CAAA;AAEpC,EAAA,IAAMG,WAAW,GAAG7B,KAAK,CAAC/B,OAAO,CAAkB,YAAM;AACvD,IAAA,IAAI6D,KAAK,CAACC,OAAO,CAAClC,KAAK,CAAC,EAAE;AACxB,MAAA,IAAAmC,MAAA,GAAAf,cAAA,CAAmDpB,KAAK,EAAA,CAAA,CAAA;AAAAoC,QAAAA,OAAA,GAAAD,MAAA,CAAA,CAAA,CAAA;AAAjDE,QAAAA,aAAa,GAAAD,OAAA,KAAA,KAAA,CAAA,GAAG,EAAE,GAAAA,OAAA;AAAAE,QAAAA,QAAA,GAAAH,MAAA,CAAA,CAAA,CAAA;AAAEI,QAAAA,eAAe,GAAAD,QAAA,KAAA,KAAA,CAAA,GAAG,EAAE,GAAAA,QAAA;AAC/C,MAAA,IAAME,OAAO,GAAGV,YAAY,GAAGO,aAAa,GAAGE,eAAe;MAC9D,OAAOE,UAAU,CAACD,OAAO,EAAE;AAAE9B,QAAAA,KAAK,EAALA;AAAM,OAAC,CAAC;AACvC,IAAA;IACA,OAAO+B,UAAU,CAACzC,KAAK,EAAE;AAAEU,MAAAA,KAAK,EAALA;AAAM,KAAC,CAAC;EACrC,CAAC,EAAE,CAACV,KAAK,EAAE8B,YAAY,EAAEpB,KAAK,CAAC,CAAC;AAEhC,EAAA,IAAMgC,YAAY,GAAG,SAAfA,YAAYA,CAAIC,CAAmB,EAAK;AAC5C,IAAA,CAAClB,YAAY,IAAIM,eAAe,CAAC,CAACD,YAAY,CAAC;AAC/C,IAAA,IAAMc,YAAY,GAAG,CAACd,YAAY,GAAGR,WAAW,GAAGE,aAAa;AAChEX,IAAAA,QAAQ,aAARA,QAAQ,KAAA,KAAA,CAAA,IAARA,QAAQ,CAAG+B,YAAY,EAAE;AAAED,MAAAA,CAAC,EAADA;AAAE,KAAC,CAAC;EACjC,CAAC;AAED,EAAA,IAAME,eAA2D,GAAG,SAA9DA,eAA2DA,CAAIF,CAAC,EAAK;AACzE,IAAA,IAAI3D,QAAQ,EAAE;AACZ,MAAA;AACF,IAAA;IAEA,IAAI,CAAC8B,YAAY,EAAE;MACjB4B,YAAY,CAACC,CAAC,CAAC;AACf,MAAA;AACF,IAAA;AACAG,IAAAA,OAAO,CAACC,OAAO,CAACjC,YAAY,EAAE,CAAC,CAC5BkC,IAAI,CAAC,UAACC,CAAC,EAAK;AACX,MAAA,IAAIA,CAAC,EAAE;QACLP,YAAY,CAACC,CAAC,CAAC;AACjB,MAAA;AACF,IAAA,CAAC,CAAC,CAAA,OAAA,CACI,CAAC,UAACA,CAAC,EAAK;MACZO,OAAO,CAAC/D,KAAK,CAAC,QAAQ,0BAAAX,MAAA,CAA0BmE,CAAC,CAAE,CAAC;AACtD,IAAA,CAAC,CAAC;EACN,CAAC;AAEDQ,EAAAA,SAAS,CAAC,YAAM;AACd,IAAA,IAAIlB,KAAK,CAACC,OAAO,CAACtB,WAAW,CAAC,IAAI,CAACA,WAAW,CAACwC,QAAQ,CAAC1C,KAAK,CAAC,EAAE;AAC9DwC,MAAAA,OAAO,CAAC/D,KAAK,CAAC,QAAQ,kCAAAX,MAAA,CAAkC6E,IAAI,CAACC,SAAS,CAAC1C,WAAW,CAAC,CAAE,CAAC;AACxF,IAAA;AACAa,IAAAA,YAAY,IAAIM,eAAe,CAACrB,KAAK,KAAKY,WAAW,CAAC;EACxD,CAAC,EAAE,CAACZ,KAAK,EAAEE,WAAW,EAAEU,WAAW,EAAEG,YAAY,CAAC,CAAC;AAEnD,EAAA,IAAA8B,mBAAA,GAAyBvF,kBAAkB,EAAE;IAArCM,IAAI,GAAAiF,mBAAA,CAAJjF,IAAI;IAAEQ,MAAM,GAAAyE,mBAAA,CAANzE,MAAM;AACpB,EAAA,IAAM0E,eAAe,GAAGC,UAAU,CAAA,EAAA,CAAAjF,MAAA,CAC7BL,WAAW,EAAA,SAAA,CAAA,EACdsC,SAAS,EAAAiD,eAAA,CAAAA,eAAA,CAAAA,eAAA,CAAA,EAAA,EAEN5E,MAAM,CAACS,OAAO,EAAGuC,YAAY,GAC7BhD,MAAM,CAACE,QAAQ,EAAGA,QAAQ,CAAA,EAC1BF,MAAM,CAACC,OAAO,EAAGA,OAAO,CAAA,EAE3BT,IAAI,CAAC2B,IAAI,CACX,CAAC;AAED,EAAA,oBACEE,KAAA,CAAAwD,aAAA,CAAA,QAAA,EAAAC,QAAA,KACM7C,SAAS,EAAA;AACb8C,IAAAA,IAAI,EAAC,QAAQ;AACbC,IAAAA,IAAI,EAAC,QAAQ;IACb9E,QAAQ,EAAEA,QAAQ,IAAID,OAAQ;AAC9B0B,IAAAA,SAAS,EAAE+C,eAAgB;AAC3BlD,IAAAA,GAAG,EAAEA,GAAI;AACTyD,IAAAA,OAAO,EAAElB;GAAgB,CAAA,eAEzB1C,KAAA,CAAAwD,aAAA,CAAA,MAAA,EAAA;IAAMlD,SAAS,EAAA,EAAA,CAAAjC,MAAA,CAAKL,WAAW,EAAA,iBAAA;AAAkB,GAAA,EAAEY,OAAO,iBAAIoB,KAAA,CAAAwD,aAAA,CAACK,OAAO,EAAA;IAACjF,OAAO,EAAA,IAAA;AAACkB,IAAAA,IAAI,EAAC;AAAO,GAAE,CAAQ,CAAC,eACtGE,KAAA,CAAAwD,aAAA,CAAA,KAAA,EAAA;IAAKlD,SAAS,EAAA,EAAA,CAAAjC,MAAA,CAAKL,WAAW,EAAA,kBAAA;GAAmB,EAAE6D,WAAiB,CAC9D,CAAC;AAEb,CAAC;AAED9B,MAAM,CAAC+D,WAAW,GAAG,QAAQ;;;;"}