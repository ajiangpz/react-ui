{"version":3,"file":"Popup.js","sources":["../../../components/utils/ref.ts","../../../components/hooks/useLastest.ts","../../../components/hooks/useMutationObserver.ts","../../../components/hooks/useWindowSize.ts","../../../components/utils/isFragment.ts","../../../components/utils/refs.ts","../../../components/utils/listener.ts","../../../components/popup/hooks/useTrigger.ts","../../../components/hooks/usePopper.ts","../../../components/popup/defaultProps.ts","../../../components/popup/Popup.tsx"],"sourcesContent":["export function getRefDom(domRef: React.RefObject<any>) {\r\n  if (\r\n    domRef.current &&\r\n    typeof domRef.current === 'object' &&\r\n    'currentElement' in domRef.current\r\n  ) {\r\n    return domRef.current.currentElement;\r\n  }\r\n  return domRef.current;\r\n}\r\n","import { useRef } from 'react';\r\n\r\nconst useLatest = <T>(value: T) => {\r\n  const ref = useRef(value);\r\n  ref.current = value;\r\n  return ref;\r\n};\r\n\r\nexport default useLatest;\r\n","import { useRef, useEffect } from 'react';\r\nimport { debounce, isEqual } from 'lodash-es';\r\nimport useLatest from './useLastest';\r\n\r\nconst DEFAULT_OPTIONS = {\r\n  debounceTime: 0,\r\n  config: {\r\n    attributes: true,\r\n    childList: true,\r\n    characterData: true,\r\n    subtree: true,\r\n  } as MutationObserverInit,\r\n};\r\n\r\ntype Options = typeof DEFAULT_OPTIONS;\r\n\r\nexport default function useMutationObservable(\r\n  targetEl: HTMLElement | null,\r\n  cb: MutationCallback,\r\n  options = DEFAULT_OPTIONS,\r\n) {\r\n  const optionsRef = useRef<Options>(null);\r\n  const signalRef = useRef(0);\r\n  const callbackRef = useLatest(cb);\r\n\r\n  if (!isEqual(options, optionsRef.current)) {\r\n    signalRef.current += 1;\r\n  }\r\n\r\n  optionsRef.current = options;\r\n\r\n  useEffect(() => {\r\n    if (!targetEl || !targetEl?.nodeType) return;\r\n    let observer: MutationObserver | null = null;\r\n    try {\r\n      if (optionsRef.current !== null) {\r\n        const { debounceTime, config } = optionsRef.current;\r\n        const mutationCallback: MutationCallback = (...args) => {\r\n          callbackRef.current(...args);\r\n        };\r\n        observer = new MutationObserver(\r\n          debounceTime > 0\r\n            ? debounce(mutationCallback, debounceTime)\r\n            : mutationCallback,\r\n        );\r\n        observer.observe(targetEl, config);\r\n      }\r\n    } catch (e) {\r\n      console.error(e);\r\n    }\r\n\r\n    return () => {\r\n      if (observer) {\r\n        observer.disconnect();\r\n        observer = null;\r\n      }\r\n    };\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, [targetEl, signalRef.current]);\r\n}\r\n","import { useEffect, useState } from 'react';\r\nimport { debounce } from 'lodash-es';\r\nimport { getWindowSize } from '../utils/dom';\r\n\r\nexport interface WindowSize {\r\n  width: number;\r\n  height: number;\r\n}\r\n\r\nfunction useWindowSize(): WindowSize {\r\n  const [size, setSize] = useState(getWindowSize);\r\n\r\n  useEffect(() => {\r\n    function handleResize() {\r\n      setSize(getWindowSize());\r\n    }\r\n\r\n    const debounceResize = debounce(handleResize, 400);\r\n\r\n    window.addEventListener('resize', debounceResize);\r\n\r\n    return () => {\r\n      window.removeEventListener('resize', debounceResize);\r\n      debounceResize.cancel();\r\n    };\r\n  }, []);\r\n\r\n  return size;\r\n}\r\n\r\nexport default useWindowSize;\r\n","// Source from:\r\n// https://github.com/react-component/util/blob/master/src/React/isFragment.ts\r\n\r\nconst REACT_ELEMENT_TYPE_18 = Symbol.for('react.element');\r\nconst REACT_ELEMENT_TYPE_19 = Symbol.for('react.transitional.element');\r\nconst REACT_FRAGMENT_TYPE = Symbol.for('react.fragment');\r\n\r\n/**\r\n * Compatible with React 18 or 19 to check if node is a Fragment.\r\n */\r\nexport default function isFragment(object: any) {\r\n  return (\r\n    // Base object type\r\n    object &&\r\n    typeof object === 'object' &&\r\n    // React Element type\r\n    (object.$$typeof === REACT_ELEMENT_TYPE_18 ||\r\n      object.$$typeof === REACT_ELEMENT_TYPE_19) &&\r\n    // React Fragment type\r\n    object.type === REACT_FRAGMENT_TYPE\r\n  );\r\n}\r\n","// Source from:\r\n// https://github.com/react-component/util/blob/master/src/ref.ts\r\n\r\nimport { isValidElement } from 'react';\r\nimport { ForwardRef, isMemo } from 'react-is';\r\nimport isFragment from './isFragment';\r\n\r\n// 判断是否支持 ref 透传\r\nexport const supportRef = (nodeOrComponent: any): boolean => {\r\n  if (!nodeOrComponent) {\r\n    return false;\r\n  }\r\n\r\n  // React 19 no need `forwardRef` anymore. So just pass if is a React element.\r\n  // eslint-disable-next-line no-prototype-builtins\r\n  if (\r\n    isReactElement(nodeOrComponent) &&\r\n    (nodeOrComponent as any).props.propertyIsEnumerable('ref')\r\n  ) {\r\n    return true;\r\n  }\r\n\r\n  const type = isMemo(nodeOrComponent)\r\n    ? nodeOrComponent.type.type\r\n    : nodeOrComponent.type;\r\n\r\n  // Function component node\r\n  if (\r\n    typeof type === 'function' &&\r\n    !type.prototype?.render &&\r\n    type.$$typeof !== ForwardRef\r\n  ) {\r\n    return false;\r\n  }\r\n\r\n  // Class component\r\n  if (\r\n    typeof nodeOrComponent === 'function' &&\r\n    !nodeOrComponent.prototype?.render &&\r\n    nodeOrComponent.$$typeof !== ForwardRef\r\n  ) {\r\n    return false;\r\n  }\r\n  return true;\r\n};\r\n\r\n// 获取 ref 中的 dom 元素\r\nexport function getRefDom(domRef: React.RefObject<any>) {\r\n  if (\r\n    domRef.current &&\r\n    typeof domRef.current === 'object' &&\r\n    'currentElement' in domRef.current\r\n  ) {\r\n    return domRef.current.currentElement;\r\n  }\r\n  return domRef.current;\r\n}\r\n\r\ninterface RefAttributes<T> extends React.Attributes {\r\n  ref: React.Ref<T>;\r\n}\r\n\r\nfunction isReactElement(node: React.ReactNode) {\r\n  return isValidElement(node) && !isFragment(node);\r\n}\r\n\r\nexport const supportNodeRef = <T = any>(\r\n  node: React.ReactNode,\r\n): node is React.ReactElement & RefAttributes<T> =>\r\n  isReactElement(node) && supportRef(node);\r\n\r\n/**\r\n * In React 19. `ref` is not a property from node.\r\n * But a property from `props.ref`.\r\n * To check if `props.ref` exist or fallback to `ref`.\r\n */\r\nexport const getNodeRef: <T = any>(\r\n  node: React.ReactNode,\r\n) => React.Ref<T> | null = (node) => {\r\n  if (node && isReactElement(node)) {\r\n    const ele = node as any;\r\n\r\n    // Source from:\r\n    // https://github.com/mui/material-ui/blob/master/packages/mui-utils/src/getReactNodeRef/getReactNodeRef.ts\r\n    // eslint-disable-next-line no-prototype-builtins\r\n    return ele.props.propertyIsEnumerable('ref') ? ele.props.ref : ele.ref;\r\n  }\r\n  return null;\r\n};\r\n","import { canUseDocument } from './dom';\r\n\r\nexport const on = ((): any => {\r\n  if (canUseDocument && document.addEventListener) {\r\n    return (\r\n      element: Node,\r\n      event: string,\r\n      handler: EventListenerOrEventListenerObject,\r\n    ): any => {\r\n      if (element && event && handler) {\r\n        element.addEventListener(event, handler, false);\r\n      }\r\n    };\r\n  }\r\n  return (\r\n    element: Node,\r\n    event: string,\r\n    handler: EventListenerOrEventListenerObject,\r\n  ): any => {\r\n    if (element && event && handler) {\r\n      (element as any).attachEvent(`on${event}`, handler);\r\n    }\r\n  };\r\n})();\r\n\r\nexport const off = ((): any => {\r\n  if (canUseDocument && document.removeEventListener) {\r\n    return (\r\n      element: Node,\r\n      event: string,\r\n      handler: EventListenerOrEventListenerObject,\r\n    ): any => {\r\n      if (element && event) {\r\n        element.removeEventListener(event, handler, false);\r\n      }\r\n    };\r\n  }\r\n  return (\r\n    element: Node,\r\n    event: string,\r\n    handler: EventListenerOrEventListenerObject,\r\n  ): any => {\r\n    if (element && event) {\r\n      (element as any).detachEvent(`on${event}`, handler);\r\n    }\r\n  };\r\n})();\r\n","import React, {\r\n  useRef,\r\n  useEffect,\r\n  isValidElement,\r\n  useCallback,\r\n  useMemo,\r\n} from 'react';\r\nimport { isFragment } from 'react-is';\r\nimport { supportRef, getRefDom, getNodeRef } from '../../utils/refs';\r\nimport composeRefs from '../../utils/composeRefs';\r\nimport { off, on } from '../../utils/listener';\r\nimport classNames from 'classnames';\r\nimport { TNode } from '../../common';\r\nconst ESC_KEY = 'Escape';\r\n\r\ninterface UseTriggerProps {\r\n  content: TNode;\r\n  disabled?: boolean;\r\n  trigger:\r\n    | 'hover'\r\n    | 'click'\r\n    | 'mousedown'\r\n    | 'focus'\r\n    | 'context-menu'\r\n    | undefined;\r\n  visible: boolean | undefined;\r\n  onVisibleChange: (visible: boolean, context: any) => void;\r\n  triggerRef: React.Ref<any>;\r\n  delay?: number | [number, number] | number[];\r\n}\r\n\r\nexport default function useTrigger({\r\n  content,\r\n  disabled,\r\n  trigger,\r\n  visible,\r\n  onVisibleChange,\r\n  triggerRef,\r\n  delay,\r\n}: UseTriggerProps) {\r\n  const hasPopupMouseDown = useRef(false);\r\n  const mouseDownTimer = useRef(0);\r\n  const visibleTimer = useRef(null);\r\n  const triggerDataKey = useRef(`t-popup--${Math.random().toFixed(10)}`);\r\n  const leaveFlag = useRef(false); // 防止多次触发显隐\r\n\r\n  // 禁用和无内容时不展示\r\n  const shouldToggle = useMemo(() => {\r\n    if (disabled) return false; // 禁用\r\n    return !disabled && content === 0 ? true : content; // 无内容时\r\n  }, [disabled, content]);\r\n\r\n  // 解析 delay 数据类型\r\n  const [appearDelay = 0, exitDelay = 0] = useMemo(() => {\r\n    if (Array.isArray(delay)) return delay;\r\n    return [delay, delay];\r\n  }, [delay]);\r\n\r\n  function callFuncWithDelay({\r\n    delay,\r\n    callback,\r\n  }: {\r\n    delay?: number;\r\n    callback: Function;\r\n  }) {\r\n    if (delay) {\r\n      clearTimeout(visibleTimer.current as any);\r\n      (visibleTimer as any).current = setTimeout(callback, delay);\r\n    } else {\r\n      callback();\r\n    }\r\n  }\r\n\r\n  // 点击 trigger overlay 以外的元素关闭\r\n  useEffect(() => {\r\n    if (!shouldToggle) return;\r\n\r\n    const handleDocumentClick = (e: any) => {\r\n      if (\r\n        getRefDom(triggerRef as any)?.contains?.(e.target) ||\r\n        hasPopupMouseDown.current\r\n      ) {\r\n        return;\r\n      }\r\n      visible && onVisibleChange(false, { e, trigger: 'document' });\r\n    };\r\n    on(document, 'mousedown', handleDocumentClick);\r\n    on(document, 'touchend', handleDocumentClick);\r\n\r\n    // 清理事件监听\r\n    return () => {\r\n      off(document, 'mousedown', handleDocumentClick);\r\n      off(document, 'touchend', handleDocumentClick);\r\n    };\r\n  }, [shouldToggle, visible, onVisibleChange, triggerRef]);\r\n\r\n  // 弹出内容交互处理\r\n  function getPopupProps(): any {\r\n    if (!shouldToggle) return {};\r\n\r\n    return {\r\n      onMouseEnter: (e: MouseEvent) => {\r\n        console.log('popup mouse enter');\r\n        // leaveFlag表示是从 trigger 元素 hover 过来的，避免频繁显示隐藏\r\n        if (trigger === 'hover' && !leaveFlag.current) {\r\n          // 清除延迟显示定时器\r\n          clearTimeout((visibleTimer as any).current);\r\n          // 立即显示\r\n          onVisibleChange(true, { e, trigger: 'trigger-element-hover' });\r\n        }\r\n      },\r\n      onMouseLeave: (e: MouseEvent) => {\r\n        console.log('popup mouse leave');\r\n        if (trigger === 'hover') {\r\n          // 防止 鼠标移出后，马上移入 popup 元素，导致 popup 重新显示 特别是有延迟显示时 是一个防抖标志\r\n          leaveFlag.current = true;\r\n\r\n          // 清除延迟显示定时器\r\n          clearTimeout((visibleTimer as any).current);\r\n          // 立即隐藏\r\n          onVisibleChange(false, { e, trigger: 'trigger-element-hover' });\r\n        }\r\n      },\r\n      onMouseDown: () => {\r\n        //  清除鼠标按下定时器\r\n        clearTimeout(mouseDownTimer.current);\r\n        // 鼠标按下时，触发 useEffect 中的 document click 事件，点击trigger和popup元素 不需要隐藏\r\n        hasPopupMouseDown.current = true;\r\n        mouseDownTimer.current = window.setTimeout(() => {\r\n          // 事件处理完毕后，重置标志\r\n          hasPopupMouseDown.current = false;\r\n        });\r\n      },\r\n      // 触摸结束时,和mouseDown 类似\r\n\r\n      onTouchEnd: () => {\r\n        clearTimeout(mouseDownTimer.current);\r\n        hasPopupMouseDown.current = true;\r\n        mouseDownTimer.current = window.setTimeout(() => {\r\n          hasPopupMouseDown.current = false;\r\n        });\r\n      },\r\n    };\r\n  }\r\n\r\n  // 整理 trigger props\r\n  function getTriggerProps(triggerNode: React.ReactElement<any>) {\r\n    if (!shouldToggle) return {};\r\n\r\n    const triggerProps: any = {\r\n      className: visible\r\n        ? classNames(triggerNode.props.className, `t-popup-open`)\r\n        : triggerNode.props.className,\r\n      onMouseDown: (e: MouseEvent) => {\r\n        if (trigger === 'mousedown') {\r\n          callFuncWithDelay({\r\n            delay: visible ? appearDelay : exitDelay,\r\n            callback: () =>\r\n              onVisibleChange(!visible, {\r\n                e,\r\n                trigger: 'trigger-element-mousedown',\r\n              }),\r\n          });\r\n        }\r\n        triggerNode.props.onMouseDown?.(e);\r\n      },\r\n      onClick: (e: MouseEvent) => {\r\n        if (trigger === 'click') {\r\n          callFuncWithDelay({\r\n            // appearDelay 和 exitDelay 分别表示点击时的延迟显示和隐藏\r\n            delay: visible ? appearDelay : exitDelay,\r\n            callback: () =>\r\n              onVisibleChange(!visible, {\r\n                e,\r\n                trigger: 'trigger-element-click',\r\n              }),\r\n          });\r\n        }\r\n        triggerNode.props.onClick?.(e);\r\n      },\r\n      onTouchStart: (e: TouchEvent) => {\r\n        if (trigger === 'hover' || trigger === 'mousedown') {\r\n          // leaveFlag 表示是从 trigger 元素 hover 过来的，避免频繁显示隐藏\r\n          leaveFlag.current = false;\r\n          callFuncWithDelay({\r\n            delay: appearDelay,\r\n            callback: () =>\r\n              onVisibleChange(true, { e, trigger: 'trigger-element-hover' }),\r\n          });\r\n        }\r\n        triggerNode.props.onTouchStart?.(e);\r\n      },\r\n      onMouseEnter: (e: MouseEvent) => {\r\n        if (trigger === 'hover') {\r\n          leaveFlag.current = false;\r\n          callFuncWithDelay({\r\n            delay: appearDelay,\r\n            callback: () =>\r\n              onVisibleChange(true, { e, trigger: 'trigger-element-hover' }),\r\n          });\r\n        }\r\n        triggerNode.props.onMouseEnter?.(e);\r\n      },\r\n      onMouseLeave: (e: MouseEvent) => {\r\n        if (trigger === 'hover') {\r\n          leaveFlag.current = false;\r\n          callFuncWithDelay({\r\n            delay: exitDelay,\r\n            callback: () =>\r\n              onVisibleChange(false, { e, trigger: 'trigger-element-hover' }),\r\n          });\r\n        }\r\n        triggerNode.props.onMouseLeave?.(e);\r\n      },\r\n      onFocus: (...args: any) => {\r\n        if (trigger === 'focus') {\r\n          callFuncWithDelay({\r\n            delay: appearDelay,\r\n            callback: () =>\r\n              onVisibleChange(true, { trigger: 'trigger-element-focus' }),\r\n          });\r\n        }\r\n        triggerNode.props.onFocus?.(...args);\r\n      },\r\n      onBlur: (...args: any) => {\r\n        if (trigger === 'focus') {\r\n          callFuncWithDelay({\r\n            delay: appearDelay,\r\n            callback: () =>\r\n              onVisibleChange(false, { trigger: 'trigger-element-blur' }),\r\n          });\r\n        }\r\n        triggerNode.props.onBlur?.(...args);\r\n      },\r\n      onContextMenu: (e: MouseEvent) => {\r\n        if (trigger === 'context-menu') {\r\n          e.preventDefault();\r\n          callFuncWithDelay({\r\n            delay: appearDelay,\r\n            callback: () =>\r\n              onVisibleChange(true, { e, trigger: 'context-menu' }),\r\n          });\r\n        }\r\n        triggerNode.props.onContextMenu?.(e);\r\n      },\r\n      onKeyDown: (e: KeyboardEvent) => {\r\n        if (e?.key === ESC_KEY) {\r\n          callFuncWithDelay({\r\n            delay: exitDelay,\r\n            callback: () =>\r\n              onVisibleChange(false, { e, trigger: 'keydown-esc' }),\r\n          });\r\n        }\r\n        triggerNode.props.onKeyDown?.(e);\r\n      },\r\n    };\r\n    // 如果支持 ref 透传，composeRefs 返回一个函数，当组件挂载时，执行函数，triggerRef 和 tiggerNode 指向触发元素的dom\r\n    if (supportRef(triggerNode)) {\r\n      triggerProps.ref = composeRefs(\r\n        triggerRef,\r\n        getNodeRef(triggerNode as any),\r\n      );\r\n    } else {\r\n      // 标记 trigger 元素\r\n      triggerProps['data-popup'] = triggerDataKey.current;\r\n    }\r\n\r\n    return triggerProps;\r\n  }\r\n\r\n  // 整理 trigger 元素\r\n  function getTriggerNode(children: React.ReactNode) {\r\n    const triggerNode =\r\n      isValidElement(children) && !isFragment(children)\r\n        ? children\r\n        : React.createElement('span', { children });\r\n\r\n    return React.cloneElement(triggerNode, getTriggerProps(triggerNode));\r\n  }\r\n\r\n  // ref 透传失败时使用 dom 查找\r\n  const getTriggerDom = useCallback(() => {\r\n    if (typeof document === 'undefined') return {};\r\n    return document.querySelector(`[data-popup=\"${triggerDataKey.current}\"]`);\r\n  }, []);\r\n\r\n  return {\r\n    getTriggerNode,\r\n    getPopupProps,\r\n    getTriggerDom,\r\n  };\r\n}\r\n","// https://github.com/floating-ui/react-popper/blob/master/src/usePopper.js\r\n// React popper was archived by the owner on Dec 6, 2024.\r\n// to maintain this hook in the repo since upgrading to support React 19.0\r\nimport { useMemo, useRef, useState } from 'react';\r\nimport { flushSync } from 'react-dom';\r\nimport {\r\n  createPopper as defaultCreatePopper,\r\n  type Options as PopperOptions,\r\n  type VirtualElement,\r\n  type State as PopperState,\r\n  type Instance as PopperInstance,\r\n} from '@popperjs/core';\r\n\r\nimport isEqual from 'react-fast-compare';\r\nimport useIsomorphicLayoutEffect from './useLayoutEffect';\r\nimport type { Styles } from '../common';\r\n\r\ntype Options = Partial<\r\n  PopperOptions & {\r\n    createPopper: typeof defaultCreatePopper;\r\n  }\r\n>;\r\n\r\ntype Attributes = {\r\n  [key: string]: { [key: string]: string };\r\n};\r\n\r\ntype State = {\r\n  styles: Record<string, Styles>;\r\n  attributes: Attributes;\r\n};\r\n\r\nimport type { ModifierPhases } from '@popperjs/core';\r\n\r\ninterface Modifier {\r\n  name: string;\r\n  enabled?: boolean;\r\n  phase?: ModifierPhases;\r\n  fn?: (data: { state: PopperState }) => void;\r\n  requires?: string[];\r\n}\r\n\r\nconst EMPTY_MODIFIERS: Modifier[] = [];\r\n\r\ntype UsePopperResult = {\r\n  state?: PopperState;\r\n  styles: Styles;\r\n  attributes: Attributes;\r\n  update: PopperInstance['update'] | null;\r\n  forceUpdate: PopperInstance['forceUpdate'] | null;\r\n};\r\n\r\nconst fromEntries = (entries: Array<[string, any]>): { [key: string]: any } =>\r\n  entries.reduce(\r\n    (acc, [key, value]) => {\r\n      acc[key] = value;\r\n      return acc;\r\n    },\r\n    {} as { [key: string]: any },\r\n  );\r\n\r\nconst usePopper = (\r\n  referenceElement?: Element | VirtualElement,\r\n  popperElement?: HTMLElement,\r\n  options: Options = {},\r\n): UsePopperResult => {\r\n  const prevOptions = useRef<PopperOptions>(null);\r\n\r\n  const optionsWithDefaults = {\r\n    onFirstUpdate: options.onFirstUpdate,\r\n    placement: options.placement || 'bottom',\r\n    strategy: options.strategy || 'absolute',\r\n    modifiers: options.modifiers || EMPTY_MODIFIERS,\r\n  };\r\n\r\n  const [state, setState] = useState<State>({\r\n    styles: {\r\n      popper: {\r\n        position: optionsWithDefaults.strategy,\r\n        left: '0',\r\n        top: '0',\r\n      },\r\n      arrow: {\r\n        position: 'absolute',\r\n      },\r\n    },\r\n    attributes: {},\r\n  });\r\n\r\n  const updateStateModifier = useMemo(\r\n    () => ({\r\n      name: 'updateState',\r\n      enabled: true,\r\n      phase: 'write' as ModifierPhases,\r\n      fn: ({ state }: { state: PopperState }) => {\r\n        const elements = Object.keys(state.elements);\r\n\r\n        flushSync(() => {\r\n          setState({\r\n            styles: fromEntries(\r\n              elements.map((element) => [element, state.styles[element] || {}]),\r\n            ),\r\n            attributes: fromEntries(\r\n              elements.map((element) => [element, state.attributes[element]]),\r\n            ),\r\n          });\r\n        });\r\n      },\r\n      requires: ['computeStyles'],\r\n    }),\r\n    [],\r\n  );\r\n\r\n  const popperOptions = useMemo(() => {\r\n    const newOptions = {\r\n      onFirstUpdate: optionsWithDefaults.onFirstUpdate,\r\n      placement: optionsWithDefaults.placement,\r\n      strategy: optionsWithDefaults.strategy,\r\n      modifiers: [\r\n        ...optionsWithDefaults.modifiers,\r\n        updateStateModifier,\r\n        {\r\n          name: 'applyStyles',\r\n          enabled: false,\r\n          phase: 'write' as ModifierPhases,\r\n        },\r\n      ],\r\n    };\r\n\r\n    if (isEqual(prevOptions.current, newOptions)) {\r\n      return prevOptions.current || newOptions;\r\n    }\r\n    prevOptions.current = newOptions;\r\n    return newOptions;\r\n  }, [\r\n    optionsWithDefaults.onFirstUpdate,\r\n    optionsWithDefaults.placement,\r\n    optionsWithDefaults.strategy,\r\n    optionsWithDefaults.modifiers,\r\n    updateStateModifier,\r\n  ]);\r\n\r\n  const popperInstanceRef = useRef<PopperInstance | null>(null);\r\n\r\n  useIsomorphicLayoutEffect(() => {\r\n    if (popperInstanceRef.current) {\r\n      popperInstanceRef.current.setOptions(popperOptions);\r\n    }\r\n  }, [popperOptions]);\r\n\r\n  useIsomorphicLayoutEffect(() => {\r\n    if (referenceElement == null || popperElement == null) {\r\n      return;\r\n    }\r\n\r\n    const createPopper = options.createPopper || defaultCreatePopper;\r\n    const popperInstance = createPopper(\r\n      referenceElement,\r\n      popperElement,\r\n      popperOptions,\r\n    );\r\n\r\n    popperInstanceRef.current = popperInstance;\r\n\r\n    return () => {\r\n      popperInstance.destroy();\r\n      popperInstanceRef.current = null;\r\n    };\r\n  }, [referenceElement, popperElement, options.createPopper]);\r\n\r\n  return {\r\n    state: popperInstanceRef.current\r\n      ? popperInstanceRef.current.state\r\n      : undefined,\r\n    styles: state.styles,\r\n    attributes: state.attributes,\r\n    update: popperInstanceRef.current ? popperInstanceRef.current.update : null,\r\n    forceUpdate: popperInstanceRef.current\r\n      ? popperInstanceRef.current.forceUpdate\r\n      : null,\r\n  };\r\n};\r\n\r\nexport default usePopper;\r\n","/**\r\n * 该文件为脚本自动生成文件，请勿随意修改。如需修改请联系 PMC\r\n * */\r\n\r\nimport { TdPopupProps } from './type';\r\n\r\nexport const popupDefaultProps: TdPopupProps = {\r\n  destroyOnClose: false,\r\n  hideEmptyPopup: false,\r\n  placement: 'top',\r\n  showArrow: false,\r\n  trigger: 'hover',\r\n};\r\n","import { Placement, type Options } from '@popperjs/core';\r\nimport { debounce, isFunction } from 'lodash-es';\r\nimport React, {\r\n  forwardRef,\r\n  useEffect,\r\n  useImperativeHandle,\r\n  useMemo,\r\n  useRef,\r\n  useState,\r\n} from 'react';\r\nimport { getRefDom } from '../utils/ref';\r\nimport Portal from '../portal/Portal';\r\nimport useControlled from '../hooks/useControlled';\r\nimport useDefaultProps from '../hooks/useDefaultProps';\r\nimport useMutationObserver from '../hooks/useMutationObserver';\r\nimport useWindowSize from '../hooks/useWindowSize';\r\nimport useTrigger from './hooks/useTrigger';\r\nimport type { TdPopupProps } from './type';\r\nimport usePopper from '../hooks/usePopper';\r\nimport { popupDefaultProps } from './defaultProps';\r\nimport classNames from 'classnames';\r\nimport { CSSTransition } from 'react-transition-group';\r\nimport { getCssVarsValue } from '../utils/style';\r\nimport useConfig from '../hooks/useConfig';\r\n\r\nexport interface PopupProps extends TdPopupProps {\r\n  // 是否触发展开收起动画，内部下拉式组件使用\r\n  expandAnimation?: boolean;\r\n  // 更新内容区域滚动条\r\n  updateScrollTop?: (content: HTMLDivElement) => void;\r\n}\r\n\r\nexport interface PopupRef {\r\n  /** 获取 popper 实例 */\r\n  getPopper: () => ReturnType<typeof usePopper>;\r\n  /** 获取 Popup dom 元素 */\r\n  getPopupElement: () => HTMLDivElement;\r\n  /** 获取 portal dom 元素 */\r\n  getPortalElement: () => HTMLDivElement;\r\n  /** 获取内容区域 dom 元素 */\r\n  getPopupContentElement: () => HTMLDivElement;\r\n  /** 设置 popup 显示隐藏 */\r\n  setVisible: (visible: boolean) => void;\r\n}\r\n\r\nconst Popup = forwardRef<PopupRef, PopupProps>((originalProps, ref) => {\r\n  const props = useDefaultProps<PopupProps>(originalProps, popupDefaultProps);\r\n  const { classPrefix } = useConfig();\r\n  const {\r\n    trigger,\r\n    content,\r\n    placement,\r\n    showArrow,\r\n    destroyOnClose,\r\n    overlayClassName,\r\n    overlayInnerClassName,\r\n    overlayStyle,\r\n    overlayInnerStyle,\r\n    triggerElement,\r\n    children = triggerElement,\r\n    disabled,\r\n    zIndex,\r\n    onScroll,\r\n    onScrollToBottom,\r\n    delay,\r\n    hideEmptyPopup,\r\n    updateScrollTop,\r\n  } = props;\r\n\r\n  // 全局配置\r\n  const { height: windowHeight, width: windowWidth } = useWindowSize();\r\n  const [visible, onVisibleChange] = useControlled(\r\n    props,\r\n    'visible',\r\n    props.onVisibleChange as any,\r\n  );\r\n  // 记录 popup 元素\r\n  // 如果内容为 null 或 undefined，且 hideEmptyPopup 为 true，则不展示 popup\r\n  const [popupElement, setPopupElement] = useState(null);\r\n  const triggerRef = useRef(null); // 记录 trigger 元素\r\n  const popupRef = useRef(null); // popup dom 元素，css transition 需要用\r\n  const portalRef = useRef(null); // portal dom 元素\r\n  const contentRef = useRef(null); // 内容部分\r\n  const popperRef = useRef<ReturnType<typeof usePopper> | null>(null); // 保存 popper 实例\r\n\r\n  // 默认动画时长\r\n  const DEFAULT_TRANSITION_TIMEOUT = 180;\r\n\r\n  // 处理切换 panel 为 null 和正常内容动态切换的情况\r\n  useEffect(() => {\r\n    if (!content && hideEmptyPopup) {\r\n      requestAnimationFrame(() => setPopupElement(null));\r\n    }\r\n  }, [content, hideEmptyPopup]);\r\n\r\n  // 判断展示浮层\r\n  const showOverlay = useMemo(() => {\r\n    if (hideEmptyPopup && !content) return false;\r\n    return visible || popupElement;\r\n  }, [hideEmptyPopup, content, visible, popupElement]);\r\n\r\n  // 转化 placement\r\n  const popperPlacement = useMemo(\r\n    () =>\r\n      placement &&\r\n      (placement\r\n        .replace(/-(left|top)$/, '-start')\r\n        .replace(/-(right|bottom)$/, '-end') as Placement),\r\n    [placement],\r\n  );\r\n  // 获取 triggerNode\r\n  const { getTriggerNode, getPopupProps, getTriggerDom } = useTrigger({\r\n    triggerRef,\r\n    content,\r\n    disabled,\r\n    trigger,\r\n    visible,\r\n    delay,\r\n    onVisibleChange,\r\n  });\r\n  // 传入popperjs 配置选项\r\n  const popperOptions = props.popperOptions as Options;\r\n  const { placement: _ignored, ...restPopperOptions } = popperOptions || {};\r\n\r\n  // popperRef 表示 popper 实例\r\n  popperRef.current = usePopper(getRefDom(triggerRef), popupElement as any, {\r\n    placement: popperPlacement as Placement,\r\n    ...restPopperOptions,\r\n  });\r\n\r\n  // arrow modifier 用于显示箭头\r\n  const hasArrowModifier = popperOptions?.modifiers?.some(\r\n    (modifier) => modifier.name === 'arrow',\r\n  );\r\n  const { styles, attributes } = popperRef.current;\r\n  // 获取 triggerNode\r\n  // 如果 children 是函数，则调用函数获取 triggerNode\r\n  // getTriggerNode 设置触发元素的事件\r\n  const triggerNode = isFunction(children)\r\n    ? getTriggerNode(children({ visible }))\r\n    : getTriggerNode(children);\r\n\r\n  const updateTimeRef = useRef(null);\r\n  // 监听 trigger 节点或内容变化动态更新 popup 定位\r\n  useMutationObserver(getRefDom(triggerRef), () => {\r\n    const isDisplayNone =\r\n      getCssVarsValue('display', getRefDom(triggerRef)) === 'none';\r\n    if (visible && !isDisplayNone) {\r\n      clearTimeout(updateTimeRef.current as any);\r\n      updateTimeRef.current = setTimeout(\r\n        () => popperRef.current?.update?.(),\r\n        0,\r\n      ) as any;\r\n    }\r\n  });\r\n  // 清理定时器\r\n  useEffect(() => () => clearTimeout(updateTimeRef.current as any), []);\r\n\r\n  // 窗口尺寸变化时调整位置\r\n  useEffect(() => {\r\n    if (visible) {\r\n      requestAnimationFrame(() => popperRef.current?.update?.());\r\n    }\r\n  }, [visible, content, windowHeight, windowWidth]);\r\n\r\n  // 下拉展开时更新内部滚动条\r\n  useEffect(() => {\r\n    if (!triggerRef.current) triggerRef.current = getTriggerDom() as any;\r\n    if (visible) {\r\n      updateScrollTop?.(contentRef.current as any);\r\n    }\r\n  }, [visible, updateScrollTop, getTriggerDom]);\r\n\r\n  function handleExited() {\r\n    !destroyOnClose &&\r\n      popupElement &&\r\n      ((popupElement as HTMLElement).style.display = 'none');\r\n  }\r\n  function handleEnter() {\r\n    !destroyOnClose &&\r\n      popupElement &&\r\n      ((popupElement as HTMLElement).style.display = 'block');\r\n  }\r\n\r\n  function handleScroll(e: React.WheelEvent<HTMLDivElement>) {\r\n    onScroll?.({ e });\r\n\r\n    // 防止多次触发添加截流\r\n    const debounceOnScrollBottom = debounce(\r\n      (e) => onScrollToBottom?.({ e }),\r\n      100,\r\n    );\r\n\r\n    const { scrollTop, clientHeight, scrollHeight } =\r\n      e.target as HTMLDivElement;\r\n    // windows 下滚动会出现小数，所以这里取整\r\n    if (clientHeight + Math.floor(scrollTop) === scrollHeight) {\r\n      // touch bottom\r\n      debounceOnScrollBottom(e);\r\n    }\r\n  }\r\n\r\n  // 整理浮层样式\r\n  function getOverlayStyle(overlayStyle: TdPopupProps['overlayStyle']) {\r\n    if (\r\n      getRefDom(triggerRef) &&\r\n      popupRef.current &&\r\n      typeof overlayStyle === 'function'\r\n    ) {\r\n      return { ...overlayStyle(getRefDom(triggerRef), popupRef.current) };\r\n    }\r\n    return { ...overlayStyle };\r\n  }\r\n\r\n  const overlay = showOverlay && (\r\n    <CSSTransition\r\n      appear\r\n      in={visible}\r\n      timeout={DEFAULT_TRANSITION_TIMEOUT}\r\n      nodeRef={portalRef}\r\n      unmountOnExit={destroyOnClose}\r\n      onEnter={handleEnter}\r\n      onExited={handleExited}\r\n      classNames={`${classPrefix}-portal`}\r\n    >\r\n      <Portal triggerNode={getRefDom(triggerRef)} attach=\"body\" ref={portalRef}>\r\n        <CSSTransition\r\n          appear\r\n          timeout={0}\r\n          in={visible}\r\n          nodeRef={popupRef}\r\n          classNames={`${classPrefix}-popup`}\r\n        >\r\n          <div\r\n            ref={(node) => {\r\n              if (node) {\r\n                popupRef.current = node as any;\r\n                setPopupElement(node as any);\r\n              }\r\n            }}\r\n            style={{\r\n              ...(styles as any).popper,\r\n              zIndex,\r\n              ...getOverlayStyle(overlayStyle),\r\n            }}\r\n            className={classNames(`${classPrefix}-popup`, overlayClassName, '')}\r\n            {...attributes.popper}\r\n            {...getPopupProps()}\r\n          >\r\n            <div\r\n              ref={contentRef}\r\n              className={classNames(\r\n                `${classPrefix}-popup__content`,\r\n                {\r\n                  [`${classPrefix}-popup__content--arrow`]: showArrow,\r\n                },\r\n                overlayInnerClassName,\r\n              )}\r\n              style={getOverlayStyle(overlayInnerStyle)}\r\n              onScroll={handleScroll}\r\n            >\r\n              {content as any}\r\n              {showArrow && (\r\n                <div\r\n                  style={(styles as any).arrow}\r\n                  className={`${classPrefix}-popup__arrow`}\r\n                  {...(hasArrowModifier && { 'data-popper-arrow': '' })}\r\n                />\r\n              )}\r\n            </div>\r\n          </div>\r\n        </CSSTransition>\r\n      </Portal>\r\n    </CSSTransition>\r\n  );\r\n  // 使用 useImperativeHandle 暴露给父组件\r\n  // 这样父组件可以通过 ref 获取 popper 实例、popup 元素\r\n  // portal 元素和内容区域元素\r\n  // 以及设置 popup 的显示隐藏状态\r\n  useImperativeHandle(ref, () => ({\r\n    getPopper: () => popperRef.current as any,\r\n    getPopupElement: () => popupRef.current as any,\r\n    getPortalElement: () => portalRef.current as any,\r\n    getPopupContentElement: () => contentRef.current as any,\r\n    setVisible: (visible: boolean) =>\r\n      onVisibleChange(visible, { trigger: 'document' }),\r\n  }));\r\n  // 这里使用 React.Fragment 包裹 triggerNode 和 overlay，确保返回一个单一的父节点\r\n  // 这样可以避免在渲染时出现多个根节点的错误\r\n  return (\r\n    <React.Fragment>\r\n      {triggerNode}\r\n      {overlay}\r\n    </React.Fragment>\r\n  );\r\n});\r\n\r\nPopup.displayName = 'Popup';\r\n\r\nexport default Popup;\r\n"],"names":["getRefDom","domRef","current","_typeof","currentElement","useLatest","value","ref","useRef","DEFAULT_OPTIONS","debounceTime","config","attributes","childList","characterData","subtree","useMutationObservable","targetEl","cb","options","arguments","length","undefined","optionsRef","signalRef","callbackRef","isEqual","useEffect","nodeType","observer","_optionsRef$current","mutationCallback","apply","MutationObserver","debounce","observe","e","console","error","disconnect","useWindowSize","_useState","useState","getWindowSize","_useState2","_slicedToArray","size","setSize","handleResize","debounceResize","window","addEventListener","removeEventListener","cancel","REACT_ELEMENT_TYPE_18","Symbol","REACT_ELEMENT_TYPE_19","REACT_FRAGMENT_TYPE","isFragment","object","$$typeof","type","supportRef","nodeOrComponent","_type$prototype","_nodeOrComponent$prot","isReactElement","props","propertyIsEnumerable","isMemo","prototype","render","ForwardRef","node","isValidElement","supportNodeRef","getNodeRef","ele","on","canUseDocument","document","element","event","handler","attachEvent","concat","off","detachEvent","ESC_KEY","useTrigger","_ref","content","disabled","trigger","visible","onVisibleChange","triggerRef","delay","hasPopupMouseDown","mouseDownTimer","visibleTimer","triggerDataKey","Math","random","toFixed","leaveFlag","shouldToggle","useMemo","_useMemo","Array","isArray","_useMemo2","_useMemo2$","appearDelay","_useMemo2$2","exitDelay","callFuncWithDelay","_ref2","callback","clearTimeout","setTimeout","handleDocumentClick","_getRefDom","_getRefDom$contains","contains","call","target","getPopupProps","onMouseEnter","log","onMouseLeave","onMouseDown","onTouchEnd","getTriggerProps","triggerNode","triggerProps","className","classNames","_triggerNode$props$on","_triggerNode$props","onClick","_triggerNode$props$on2","_triggerNode$props2","onTouchStart","_triggerNode$props$on3","_triggerNode$props3","_triggerNode$props$on4","_triggerNode$props4","_triggerNode$props$on5","_triggerNode$props5","onFocus","_triggerNode$props$on6","_triggerNode$props6","_len","args","_key","onBlur","_triggerNode$props$on7","_triggerNode$props7","_len2","_key2","onContextMenu","_triggerNode$props$on8","_triggerNode$props8","preventDefault","onKeyDown","_triggerNode$props$on9","_triggerNode$props9","key","composeRefs","getTriggerNode","children","React","createElement","cloneElement","getTriggerDom","useCallback","querySelector","EMPTY_MODIFIERS","fromEntries","entries","reduce","acc","usePopper","referenceElement","popperElement","prevOptions","optionsWithDefaults","onFirstUpdate","placement","strategy","modifiers","styles","popper","position","left","top","arrow","state","setState","updateStateModifier","name","enabled","phase","fn","_ref3","elements","Object","keys","flushSync","map","requires","popperOptions","newOptions","_toConsumableArray","popperInstanceRef","useIsomorphicLayoutEffect","setOptions","createPopper","defaultCreatePopper","popperInstance","destroy","update","forceUpdate","popupDefaultProps","destroyOnClose","hideEmptyPopup","showArrow","Popup","forwardRef","originalProps","_popperOptions$modifi","useDefaultProps","_useConfig","useConfig","classPrefix","overlayClassName","overlayInnerClassName","overlayStyle","overlayInnerStyle","triggerElement","_props$children","zIndex","onScroll","onScrollToBottom","updateScrollTop","_useWindowSize","windowHeight","height","windowWidth","width","_useControlled","useControlled","_useControlled2","popupElement","setPopupElement","popupRef","portalRef","contentRef","popperRef","DEFAULT_TRANSITION_TIMEOUT","requestAnimationFrame","showOverlay","popperPlacement","replace","_useTrigger","_ignored","restPopperOptions","_objectWithoutProperties","_excluded","_objectSpread","hasArrowModifier","some","modifier","_popperRef$current","isFunction","updateTimeRef","useMutationObserver","isDisplayNone","getCssVarsValue","_popperRef$current2","_popperRef$current2$u","_popperRef$current3","_popperRef$current3$u","handleExited","style","display","handleEnter","handleScroll","debounceOnScrollBottom","scrollTop","clientHeight","scrollHeight","floor","getOverlayStyle","overlay","CSSTransition","appear","timeout","nodeRef","unmountOnExit","onEnter","onExited","Portal","attach","_extends","_defineProperty","useImperativeHandle","getPopper","getPopupElement","getPortalElement","getPopupContentElement","setVisible","Fragment","displayName"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;AAAO,SAASA,WAASA,CAACC,MAA4B,EAAE;AACtD,EAAA,IACEA,MAAM,CAACC,OAAO,IACdC,OAAA,CAAOF,MAAM,CAACC,OAAO,CAAA,KAAK,QAAQ,IAClC,gBAAgB,IAAID,MAAM,CAACC,OAAO,EAClC;AACA,IAAA,OAAOD,MAAM,CAACC,OAAO,CAACE,cAAc;AACtC,EAAA;EACA,OAAOH,MAAM,CAACC,OAAO;AACvB;;ACPA,IAAMG,SAAS,GAAG,SAAZA,SAASA,CAAOC,KAAQ,EAAK;AACjC,EAAA,IAAMC,GAAG,GAAGC,MAAM,CAACF,KAAK,CAAC;EACzBC,GAAG,CAACL,OAAO,GAAGI,KAAK;AACnB,EAAA,OAAOC,GAAG;AACZ,CAAC;;ACFD,IAAME,eAAe,GAAG;AACtBC,EAAAA,YAAY,EAAE,CAAC;AACfC,EAAAA,MAAM,EAAE;AACNC,IAAAA,UAAU,EAAE,IAAI;AAChBC,IAAAA,SAAS,EAAE,IAAI;AACfC,IAAAA,aAAa,EAAE,IAAI;AACnBC,IAAAA,OAAO,EAAE;AACX;AACF,CAAC;AAIc,SAASC,qBAAqBA,CAC3CC,QAA4B,EAC5BC,EAAoB,EAEpB;AAAA,EAAA,IADAC,OAAO,GAAAC,SAAA,CAAAC,MAAA,GAAA,CAAA,IAAAD,SAAA,CAAA,CAAA,CAAA,KAAAE,SAAA,GAAAF,SAAA,CAAA,CAAA,CAAA,GAAGX,eAAe;AAEzB,EAAA,IAAMc,UAAU,GAAGf,MAAM,CAAU,IAAI,CAAC;AACxC,EAAA,IAAMgB,SAAS,GAAGhB,MAAM,CAAC,CAAC,CAAC;AAC3B,EAAA,IAAMiB,WAAW,GAAGpB,SAAS,CAACa,EAAE,CAAC;EAEjC,IAAI,CAACQ,OAAO,CAACP,OAAO,EAAEI,UAAU,CAACrB,OAAO,CAAC,EAAE;IACzCsB,SAAS,CAACtB,OAAO,IAAI,CAAC;AACxB,EAAA;EAEAqB,UAAU,CAACrB,OAAO,GAAGiB,OAAO;AAE5BQ,EAAAA,SAAS,CAAC,YAAM;IACd,IAAI,CAACV,QAAQ,IAAI,EAACA,QAAQ,KAAA,IAAA,IAARA,QAAQ,KAAA,KAAA,CAAA,IAARA,QAAQ,CAAEW,QAAQ,CAAA,EAAE;IACtC,IAAIC,QAAiC,GAAG,IAAI;IAC5C,IAAI;AACF,MAAA,IAAIN,UAAU,CAACrB,OAAO,KAAK,IAAI,EAAE;AAC/B,QAAA,IAAA4B,mBAAA,GAAiCP,UAAU,CAACrB,OAAO;UAA3CQ,YAAY,GAAAoB,mBAAA,CAAZpB,YAAY;UAAEC,MAAM,GAAAmB,mBAAA,CAANnB,MAAM;AAC5B,QAAA,IAAMoB,gBAAkC,GAAG,SAArCA,gBAAkCA,GAAgB;UACtDN,WAAW,CAACvB,OAAO,CAAA8B,KAAA,CAAnBP,WAAW,EAAAL,SAAgB,CAAC;QAC9B,CAAC;AACDS,QAAAA,QAAQ,GAAG,IAAII,gBAAgB,CAC7BvB,YAAY,GAAG,CAAC,GACZwB,QAAQ,CAACH,gBAAgB,EAAErB,YAAY,CAAC,GACxCqB,gBACN,CAAC;AACDF,QAAAA,QAAQ,CAACM,OAAO,CAAClB,QAAQ,EAAEN,MAAM,CAAC;AACpC,MAAA;IACF,CAAC,CAAC,OAAOyB,CAAC,EAAE;AACVC,MAAAA,OAAO,CAACC,KAAK,CAACF,CAAC,CAAC;AAClB,IAAA;AAEA,IAAA,OAAO,YAAM;AACX,MAAA,IAAIP,QAAQ,EAAE;QACZA,QAAQ,CAACU,UAAU,EAAE;AACrBV,QAAAA,QAAQ,GAAG,IAAI;AACjB,MAAA;IACF,CAAC;AACD;EACF,CAAC,EAAE,CAACZ,QAAQ,EAAEO,SAAS,CAACtB,OAAO,CAAC,CAAC;AACnC;;AClDA,SAASsC,aAAaA,GAAe;AACnC,EAAA,IAAAC,SAAA,GAAwBC,QAAQ,CAACC,aAAa,CAAC;IAAAC,UAAA,GAAAC,cAAA,CAAAJ,SAAA,EAAA,CAAA,CAAA;AAAxCK,IAAAA,IAAI,GAAAF,UAAA,CAAA,CAAA,CAAA;AAAEG,IAAAA,OAAO,GAAAH,UAAA,CAAA,CAAA,CAAA;AAEpBjB,EAAAA,SAAS,CAAC,YAAM;IACd,SAASqB,YAAYA,GAAG;AACtBD,MAAAA,OAAO,CAACJ,aAAa,EAAE,CAAC;AAC1B,IAAA;AAEA,IAAA,IAAMM,cAAc,GAAGf,QAAQ,CAACc,YAAY,EAAE,GAAG,CAAC;AAElDE,IAAAA,MAAM,CAACC,gBAAgB,CAAC,QAAQ,EAAEF,cAAc,CAAC;AAEjD,IAAA,OAAO,YAAM;AACXC,MAAAA,MAAM,CAACE,mBAAmB,CAAC,QAAQ,EAAEH,cAAc,CAAC;MACpDA,cAAc,CAACI,MAAM,EAAE;IACzB,CAAC;EACH,CAAC,EAAE,EAAE,CAAC;AAEN,EAAA,OAAOP,IAAI;AACb;;AC5BA;AACA;;AAEA,IAAMQ,qBAAqB,GAAGC,MAAM,CAAA,KAAA,CAAI,CAAC,eAAe,CAAC;AACzD,IAAMC,qBAAqB,GAAGD,MAAM,CAAA,KAAA,CAAI,CAAC,4BAA4B,CAAC;AACtE,IAAME,mBAAmB,GAAGF,MAAM,CAAA,KAAA,CAAI,CAAC,gBAAgB,CAAC;;AAExD;AACA;AACA;AACe,SAASG,UAAUA,CAACC,MAAW,EAAE;AAC9C,EAAA;AACE;AACAA,IAAAA,MAAM,IACNxD,OAAA,CAAOwD,MAAM,MAAK,QAAQ;AAC1B;IACCA,MAAM,CAACC,QAAQ,KAAKN,qBAAqB,IACxCK,MAAM,CAACC,QAAQ,KAAKJ,qBAAqB,CAAC;AAC5C;IACAG,MAAM,CAACE,IAAI,KAAKJ;AAAmB;AAEvC;;ACdA;AACO,IAAMK,UAAU,GAAG,SAAbA,UAAUA,CAAIC,eAAoB,EAAc;EAAA,IAAAC,eAAA,EAAAC,qBAAA;EAC3D,IAAI,CAACF,eAAe,EAAE;AACpB,IAAA,OAAO,KAAK;AACd,EAAA;;AAEA;AACA;AACA,EAAA,IACEG,cAAc,CAACH,eAAe,CAAC,IAC9BA,eAAe,CAASI,KAAK,CAACC,oBAAoB,CAAC,KAAK,CAAC,EAC1D;AACA,IAAA,OAAO,IAAI;AACb,EAAA;AAEA,EAAA,IAAMP,IAAI,GAAGQ,MAAM,CAACN,eAAe,CAAC,GAChCA,eAAe,CAACF,IAAI,CAACA,IAAI,GACzBE,eAAe,CAACF,IAAI;;AAExB;EACA,IACE,OAAOA,IAAI,KAAK,UAAU,IAC1B,EAAA,CAAAG,eAAA,GAACH,IAAI,CAACS,SAAS,cAAAN,eAAA,KAAA,KAAA,CAAA,IAAdA,eAAA,CAAgBO,MAAM,CAAA,IACvBV,IAAI,CAACD,QAAQ,KAAKY,UAAU,EAC5B;AACA,IAAA,OAAO,KAAK;AACd,EAAA;;AAEA;EACA,IACE,OAAOT,eAAe,KAAK,UAAU,IACrC,EAAA,CAAAE,qBAAA,GAACF,eAAe,CAACO,SAAS,cAAAL,qBAAA,KAAA,KAAA,CAAA,IAAzBA,qBAAA,CAA2BM,MAAM,CAAA,IAClCR,eAAe,CAACH,QAAQ,KAAKY,UAAU,EACvC;AACA,IAAA,OAAO,KAAK;AACd,EAAA;AACA,EAAA,OAAO,IAAI;AACb,CAAC;;AAED;AACO,SAASxE,SAASA,CAACC,MAA4B,EAAE;AACtD,EAAA,IACEA,MAAM,CAACC,OAAO,IACdC,OAAA,CAAOF,MAAM,CAACC,OAAO,CAAA,KAAK,QAAQ,IAClC,gBAAgB,IAAID,MAAM,CAACC,OAAO,EAClC;AACA,IAAA,OAAOD,MAAM,CAACC,OAAO,CAACE,cAAc;AACtC,EAAA;EACA,OAAOH,MAAM,CAACC,OAAO;AACvB;AAMA,SAASgE,cAAcA,CAACO,IAAqB,EAAE;EAC7C,oBAAOC,cAAc,CAACD,IAAI,CAAC,IAAI,CAACf,UAAU,CAACe,IAAI,CAAC;AAClD;AAEO,IAAME,cAAc,GAAG,SAAjBA,cAAcA,CACzBF,IAAqB,EAAA;EAAA,OAErBP,cAAc,CAACO,IAAI,CAAC,IAAIX,UAAU,CAACW,IAAI,CAAC;AAAA,CAAA;;AAE1C;AACA;AACA;AACA;AACA;AACO,IAAMG,UAEW,GAAG,SAFdA,UAEWA,CAAIH,IAAI,EAAK;AACnC,EAAA,IAAIA,IAAI,IAAIP,cAAc,CAACO,IAAI,CAAC,EAAE;IAChC,IAAMI,GAAG,GAAGJ,IAAW;;AAEvB;AACA;AACA;AACA,IAAA,OAAOI,GAAG,CAACV,KAAK,CAACC,oBAAoB,CAAC,KAAK,CAAC,GAAGS,GAAG,CAACV,KAAK,CAAC5D,GAAG,GAAGsE,GAAG,CAACtE,GAAG;AACxE,EAAA;AACA,EAAA,OAAO,IAAI;AACb,CAAC;;ACtFM,IAAMuE,EAAE,GAAI,YAAW;AAC5B,EAAA,IAAIC,cAAc,IAAIC,QAAQ,CAAC7B,gBAAgB,EAAE;AAC/C,IAAA,OAAO,UACL8B,OAAa,EACbC,KAAa,EACbC,OAA2C,EACnC;AACR,MAAA,IAAIF,OAAO,IAAIC,KAAK,IAAIC,OAAO,EAAE;QAC/BF,OAAO,CAAC9B,gBAAgB,CAAC+B,KAAK,EAAEC,OAAO,EAAE,KAAK,CAAC;AACjD,MAAA;IACF,CAAC;AACH,EAAA;AACA,EAAA,OAAO,UACLF,OAAa,EACbC,KAAa,EACbC,OAA2C,EACnC;AACR,IAAA,IAAIF,OAAO,IAAIC,KAAK,IAAIC,OAAO,EAAE;MAC9BF,OAAO,CAASG,WAAW,CAAA,IAAA,CAAAC,MAAA,CAAMH,KAAK,CAAA,EAAIC,OAAO,CAAC;AACrD,IAAA;EACF,CAAC;AACH,CAAC,EAAG;AAEG,IAAMG,GAAG,GAAI,YAAW;AAC7B,EAAA,IAAIP,cAAc,IAAIC,QAAQ,CAAC5B,mBAAmB,EAAE;AAClD,IAAA,OAAO,UACL6B,OAAa,EACbC,KAAa,EACbC,OAA2C,EACnC;MACR,IAAIF,OAAO,IAAIC,KAAK,EAAE;QACpBD,OAAO,CAAC7B,mBAAmB,CAAC8B,KAAK,EAAEC,OAAO,EAAE,KAAK,CAAC;AACpD,MAAA;IACF,CAAC;AACH,EAAA;AACA,EAAA,OAAO,UACLF,OAAa,EACbC,KAAa,EACbC,OAA2C,EACnC;IACR,IAAIF,OAAO,IAAIC,KAAK,EAAE;MACnBD,OAAO,CAASM,WAAW,CAAA,IAAA,CAAAF,MAAA,CAAMH,KAAK,CAAA,EAAIC,OAAO,CAAC;AACrD,IAAA;EACF,CAAC;AACH,CAAC,EAAG;;ACjCJ,IAAMK,OAAO,GAAG,QAAQ;AAkBT,SAASC,UAAUA,CAAAC,IAAA,EAQd;AAAA,EAAA,IAPlBC,OAAO,GAAAD,IAAA,CAAPC,OAAO;IACPC,QAAQ,GAAAF,IAAA,CAARE,QAAQ;IACRC,OAAO,GAAAH,IAAA,CAAPG,OAAO;IACPC,OAAO,GAAAJ,IAAA,CAAPI,OAAO;IACPC,eAAe,GAAAL,IAAA,CAAfK,eAAe;IACfC,UAAU,GAAAN,IAAA,CAAVM,UAAU;IACVC,KAAK,GAAAP,IAAA,CAALO,KAAK;AAEL,EAAA,IAAMC,iBAAiB,GAAG1F,MAAM,CAAC,KAAK,CAAC;AACvC,EAAA,IAAM2F,cAAc,GAAG3F,MAAM,CAAC,CAAC,CAAC;AAChC,EAAA,IAAM4F,YAAY,GAAG5F,MAAM,CAAC,IAAI,CAAC;AACjC,EAAA,IAAM6F,cAAc,GAAG7F,MAAM,CAAA,WAAA,CAAA6E,MAAA,CAAaiB,IAAI,CAACC,MAAM,EAAE,CAACC,OAAO,CAAC,EAAE,CAAC,CAAE,CAAC;AACtE,EAAA,IAAMC,SAAS,GAAGjG,MAAM,CAAC,KAAK,CAAC,CAAC;;AAEhC;AACA,EAAA,IAAMkG,YAAY,GAAGC,OAAO,CAAC,YAAM;AACjC,IAAA,IAAIf,QAAQ,EAAE,OAAO,KAAK,CAAC;IAC3B,OAAO,CAACA,QAAQ,IAAID,OAAO,KAAK,CAAC,GAAG,IAAI,GAAGA,OAAO,CAAC;AACrD,EAAA,CAAC,EAAE,CAACC,QAAQ,EAAED,OAAO,CAAC,CAAC;;AAEvB;AACA,EAAA,IAAAiB,QAAA,GAAyCD,OAAO,CAAC,YAAM;MACrD,IAAIE,KAAK,CAACC,OAAO,CAACb,KAAK,CAAC,EAAE,OAAOA,KAAK;AACtC,MAAA,OAAO,CAACA,KAAK,EAAEA,KAAK,CAAC;AACvB,IAAA,CAAC,EAAE,CAACA,KAAK,CAAC,CAAC;IAAAc,SAAA,GAAAlE,cAAA,CAAA+D,QAAA,EAAA,CAAA,CAAA;AAAAI,IAAAA,UAAA,GAAAD,SAAA,CAAA,CAAA,CAAA;AAHJE,IAAAA,WAAW,GAAAD,UAAA,KAAA,KAAA,CAAA,GAAG,CAAC,GAAAA,UAAA;AAAAE,IAAAA,WAAA,GAAAH,SAAA,CAAA,CAAA,CAAA;AAAEI,IAAAA,SAAS,GAAAD,WAAA,KAAA,KAAA,CAAA,GAAG,CAAC,GAAAA,WAAA;EAKrC,SAASE,iBAAiBA,CAAAC,KAAA,EAMvB;AAAA,IAAA,IALDpB,KAAK,GAAAoB,KAAA,CAALpB,KAAK;MACLqB,QAAQ,GAAAD,KAAA,CAARC,QAAQ;AAKR,IAAA,IAAIrB,KAAK,EAAE;AACTsB,MAAAA,YAAY,CAACnB,YAAY,CAAClG,OAAc,CAAC;MACxCkG,YAAY,CAASlG,OAAO,GAAGsH,UAAU,CAACF,QAAQ,EAAErB,KAAK,CAAC;AAC7D,IAAA,CAAC,MAAM;AACLqB,MAAAA,QAAQ,EAAE;AACZ,IAAA;AACF,EAAA;;AAEA;AACA3F,EAAAA,SAAS,CAAC,YAAM;IACd,IAAI,CAAC+E,YAAY,EAAE;AAEnB,IAAA,IAAMe,mBAAmB,GAAG,SAAtBA,mBAAmBA,CAAIrF,CAAM,EAAK;MAAA,IAAAsF,UAAA,EAAAC,mBAAA;AACtC,MAAA,IACE,CAAAD,UAAA,GAAA1H,SAAS,CAACgG,UAAiB,CAAC,MAAA,IAAA,IAAA0B,UAAA,KAAA,KAAA,CAAA,IAAA,CAAAC,mBAAA,GAA5BD,UAAA,CAA8BE,QAAQ,MAAA,IAAA,IAAAD,mBAAA,KAAA,KAAA,CAAA,IAAtCA,mBAAA,CAAAE,IAAA,CAAAH,UAAA,EAAyCtF,CAAC,CAAC0F,MAAM,CAAC,IAClD5B,iBAAiB,CAAChG,OAAO,EACzB;AACA,QAAA;AACF,MAAA;AACA4F,MAAAA,OAAO,IAAIC,eAAe,CAAC,KAAK,EAAE;AAAE3D,QAAAA,CAAC,EAADA,CAAC;AAAEyD,QAAAA,OAAO,EAAE;AAAW,OAAC,CAAC;IAC/D,CAAC;AACDf,IAAAA,EAAE,CAACE,QAAQ,EAAE,WAAW,EAAEyC,mBAAmB,CAAC;AAC9C3C,IAAAA,EAAE,CAACE,QAAQ,EAAE,UAAU,EAAEyC,mBAAmB,CAAC;;AAE7C;AACA,IAAA,OAAO,YAAM;AACXnC,MAAAA,GAAG,CAACN,QAAQ,EAAE,WAAW,EAAEyC,mBAAmB,CAAC;AAC/CnC,MAAAA,GAAG,CAACN,QAAQ,EAAE,UAAU,EAAEyC,mBAAmB,CAAC;IAChD,CAAC;EACH,CAAC,EAAE,CAACf,YAAY,EAAEZ,OAAO,EAAEC,eAAe,EAAEC,UAAU,CAAC,CAAC;;AAExD;EACA,SAAS+B,aAAaA,GAAQ;AAC5B,IAAA,IAAI,CAACrB,YAAY,EAAE,OAAO,EAAE;IAE5B,OAAO;AACLsB,MAAAA,YAAY,EAAE,SAAdA,YAAYA,CAAG5F,CAAa,EAAK;AAC/BC,QAAAA,OAAO,CAAC4F,GAAG,CAAC,mBAAmB,CAAC;AAChC;QACA,IAAIpC,OAAO,KAAK,OAAO,IAAI,CAACY,SAAS,CAACvG,OAAO,EAAE;AAC7C;AACAqH,UAAAA,YAAY,CAAEnB,YAAY,CAASlG,OAAO,CAAC;AAC3C;UACA6F,eAAe,CAAC,IAAI,EAAE;AAAE3D,YAAAA,CAAC,EAADA,CAAC;AAAEyD,YAAAA,OAAO,EAAE;AAAwB,WAAC,CAAC;AAChE,QAAA;MACF,CAAC;AACDqC,MAAAA,YAAY,EAAE,SAAdA,YAAYA,CAAG9F,CAAa,EAAK;AAC/BC,QAAAA,OAAO,CAAC4F,GAAG,CAAC,mBAAmB,CAAC;QAChC,IAAIpC,OAAO,KAAK,OAAO,EAAE;AACvB;UACAY,SAAS,CAACvG,OAAO,GAAG,IAAI;;AAExB;AACAqH,UAAAA,YAAY,CAAEnB,YAAY,CAASlG,OAAO,CAAC;AAC3C;UACA6F,eAAe,CAAC,KAAK,EAAE;AAAE3D,YAAAA,CAAC,EAADA,CAAC;AAAEyD,YAAAA,OAAO,EAAE;AAAwB,WAAC,CAAC;AACjE,QAAA;MACF,CAAC;AACDsC,MAAAA,WAAW,EAAE,SAAbA,WAAWA,GAAQ;AACjB;AACAZ,QAAAA,YAAY,CAACpB,cAAc,CAACjG,OAAO,CAAC;AACpC;QACAgG,iBAAiB,CAAChG,OAAO,GAAG,IAAI;AAChCiG,QAAAA,cAAc,CAACjG,OAAO,GAAGgD,MAAM,CAACsE,UAAU,CAAC,YAAM;AAC/C;UACAtB,iBAAiB,CAAChG,OAAO,GAAG,KAAK;AACnC,QAAA,CAAC,CAAC;MACJ,CAAC;AACD;;AAEAkI,MAAAA,UAAU,EAAE,SAAZA,UAAUA,GAAQ;AAChBb,QAAAA,YAAY,CAACpB,cAAc,CAACjG,OAAO,CAAC;QACpCgG,iBAAiB,CAAChG,OAAO,GAAG,IAAI;AAChCiG,QAAAA,cAAc,CAACjG,OAAO,GAAGgD,MAAM,CAACsE,UAAU,CAAC,YAAM;UAC/CtB,iBAAiB,CAAChG,OAAO,GAAG,KAAK;AACnC,QAAA,CAAC,CAAC;AACJ,MAAA;KACD;AACH,EAAA;;AAEA;EACA,SAASmI,eAAeA,CAACC,WAAoC,EAAE;AAC7D,IAAA,IAAI,CAAC5B,YAAY,EAAE,OAAO,EAAE;AAE5B,IAAA,IAAM6B,YAAiB,GAAG;AACxBC,MAAAA,SAAS,EAAE1C,OAAO,GACd2C,UAAU,CAACH,WAAW,CAACnE,KAAK,CAACqE,SAAS,gBAAgB,CAAC,GACvDF,WAAW,CAACnE,KAAK,CAACqE,SAAS;AAC/BL,MAAAA,WAAW,EAAE,SAAbA,WAAWA,CAAG/F,CAAa,EAAK;QAAA,IAAAsG,qBAAA,EAAAC,kBAAA;QAC9B,IAAI9C,OAAO,KAAK,WAAW,EAAE;AAC3BuB,UAAAA,iBAAiB,CAAC;AAChBnB,YAAAA,KAAK,EAAEH,OAAO,GAAGmB,WAAW,GAAGE,SAAS;YACxCG,QAAQ,EAAE,SAAVA,QAAQA,GAAA;AAAA,cAAA,OACNvB,eAAe,CAAC,CAACD,OAAO,EAAE;AACxB1D,gBAAAA,CAAC,EAADA,CAAC;AACDyD,gBAAAA,OAAO,EAAE;AACX,eAAC,CAAC;AAAA,YAAA;AACN,WAAC,CAAC;AACJ,QAAA;AACA,QAAA,CAAA6C,qBAAA,GAAA,CAAAC,kBAAA,GAAAL,WAAW,CAACnE,KAAK,EAACgE,WAAW,cAAAO,qBAAA,KAAA,KAAA,CAAA,IAA7BA,qBAAA,CAAAb,IAAA,CAAAc,kBAAA,EAAgCvG,CAAC,CAAC;MACpC,CAAC;AACDwG,MAAAA,OAAO,EAAE,SAATA,OAAOA,CAAGxG,CAAa,EAAK;QAAA,IAAAyG,sBAAA,EAAAC,mBAAA;QAC1B,IAAIjD,OAAO,KAAK,OAAO,EAAE;AACvBuB,UAAAA,iBAAiB,CAAC;AAChB;AACAnB,YAAAA,KAAK,EAAEH,OAAO,GAAGmB,WAAW,GAAGE,SAAS;YACxCG,QAAQ,EAAE,SAAVA,QAAQA,GAAA;AAAA,cAAA,OACNvB,eAAe,CAAC,CAACD,OAAO,EAAE;AACxB1D,gBAAAA,CAAC,EAADA,CAAC;AACDyD,gBAAAA,OAAO,EAAE;AACX,eAAC,CAAC;AAAA,YAAA;AACN,WAAC,CAAC;AACJ,QAAA;AACA,QAAA,CAAAgD,sBAAA,GAAA,CAAAC,mBAAA,GAAAR,WAAW,CAACnE,KAAK,EAACyE,OAAO,cAAAC,sBAAA,KAAA,KAAA,CAAA,IAAzBA,sBAAA,CAAAhB,IAAA,CAAAiB,mBAAA,EAA4B1G,CAAC,CAAC;MAChC,CAAC;AACD2G,MAAAA,YAAY,EAAE,SAAdA,YAAYA,CAAG3G,CAAa,EAAK;QAAA,IAAA4G,sBAAA,EAAAC,mBAAA;AAC/B,QAAA,IAAIpD,OAAO,KAAK,OAAO,IAAIA,OAAO,KAAK,WAAW,EAAE;AAClD;UACAY,SAAS,CAACvG,OAAO,GAAG,KAAK;AACzBkH,UAAAA,iBAAiB,CAAC;AAChBnB,YAAAA,KAAK,EAAEgB,WAAW;YAClBK,QAAQ,EAAE,SAAVA,QAAQA,GAAA;cAAA,OACNvB,eAAe,CAAC,IAAI,EAAE;AAAE3D,gBAAAA,CAAC,EAADA,CAAC;AAAEyD,gBAAAA,OAAO,EAAE;AAAwB,eAAC,CAAC;AAAA,YAAA;AAClE,WAAC,CAAC;AACJ,QAAA;AACA,QAAA,CAAAmD,sBAAA,GAAA,CAAAC,mBAAA,GAAAX,WAAW,CAACnE,KAAK,EAAC4E,YAAY,cAAAC,sBAAA,KAAA,KAAA,CAAA,IAA9BA,sBAAA,CAAAnB,IAAA,CAAAoB,mBAAA,EAAiC7G,CAAC,CAAC;MACrC,CAAC;AACD4F,MAAAA,YAAY,EAAE,SAAdA,YAAYA,CAAG5F,CAAa,EAAK;QAAA,IAAA8G,sBAAA,EAAAC,mBAAA;QAC/B,IAAItD,OAAO,KAAK,OAAO,EAAE;UACvBY,SAAS,CAACvG,OAAO,GAAG,KAAK;AACzBkH,UAAAA,iBAAiB,CAAC;AAChBnB,YAAAA,KAAK,EAAEgB,WAAW;YAClBK,QAAQ,EAAE,SAAVA,QAAQA,GAAA;cAAA,OACNvB,eAAe,CAAC,IAAI,EAAE;AAAE3D,gBAAAA,CAAC,EAADA,CAAC;AAAEyD,gBAAAA,OAAO,EAAE;AAAwB,eAAC,CAAC;AAAA,YAAA;AAClE,WAAC,CAAC;AACJ,QAAA;AACA,QAAA,CAAAqD,sBAAA,GAAA,CAAAC,mBAAA,GAAAb,WAAW,CAACnE,KAAK,EAAC6D,YAAY,cAAAkB,sBAAA,KAAA,KAAA,CAAA,IAA9BA,sBAAA,CAAArB,IAAA,CAAAsB,mBAAA,EAAiC/G,CAAC,CAAC;MACrC,CAAC;AACD8F,MAAAA,YAAY,EAAE,SAAdA,YAAYA,CAAG9F,CAAa,EAAK;QAAA,IAAAgH,sBAAA,EAAAC,mBAAA;QAC/B,IAAIxD,OAAO,KAAK,OAAO,EAAE;UACvBY,SAAS,CAACvG,OAAO,GAAG,KAAK;AACzBkH,UAAAA,iBAAiB,CAAC;AAChBnB,YAAAA,KAAK,EAAEkB,SAAS;YAChBG,QAAQ,EAAE,SAAVA,QAAQA,GAAA;cAAA,OACNvB,eAAe,CAAC,KAAK,EAAE;AAAE3D,gBAAAA,CAAC,EAADA,CAAC;AAAEyD,gBAAAA,OAAO,EAAE;AAAwB,eAAC,CAAC;AAAA,YAAA;AACnE,WAAC,CAAC;AACJ,QAAA;AACA,QAAA,CAAAuD,sBAAA,GAAA,CAAAC,mBAAA,GAAAf,WAAW,CAACnE,KAAK,EAAC+D,YAAY,cAAAkB,sBAAA,KAAA,KAAA,CAAA,IAA9BA,sBAAA,CAAAvB,IAAA,CAAAwB,mBAAA,EAAiCjH,CAAC,CAAC;MACrC,CAAC;AACDkH,MAAAA,OAAO,EAAE,SAATA,OAAOA,GAAoB;QAAA,IAAAC,sBAAA,EAAAC,mBAAA;QACzB,IAAI3D,OAAO,KAAK,OAAO,EAAE;AACvBuB,UAAAA,iBAAiB,CAAC;AAChBnB,YAAAA,KAAK,EAAEgB,WAAW;YAClBK,QAAQ,EAAE,SAAVA,QAAQA,GAAA;cAAA,OACNvB,eAAe,CAAC,IAAI,EAAE;AAAEF,gBAAAA,OAAO,EAAE;AAAwB,eAAC,CAAC;AAAA,YAAA;AAC/D,WAAC,CAAC;AACJ,QAAA;AAAC,QAAA,KAAA,IAAA4D,IAAA,GAAArI,SAAA,CAAAC,MAAA,EAPUqI,IAAI,GAAA,IAAA7C,KAAA,CAAA4C,IAAA,GAAAE,IAAA,GAAA,CAAA,EAAAA,IAAA,GAAAF,IAAA,EAAAE,IAAA,EAAA,EAAA;AAAJD,UAAAA,IAAI,CAAAC,IAAA,CAAA,GAAAvI,SAAA,CAAAuI,IAAA,CAAA;AAAA,QAAA;QAQf,CAAAJ,sBAAA,GAAA,CAAAC,mBAAA,GAAAlB,WAAW,CAACnE,KAAK,EAACmF,OAAO,MAAA,IAAA,IAAAC,sBAAA,KAAA,KAAA,CAAA,IAAzBA,sBAAA,CAAA1B,IAAA,CAAA7F,KAAA,CAAAuH,sBAAA,EAAA,CAAAC,mBAAA,CAAA,CAAAnE,MAAA,CAA+BqE,IAAI,CAAA,CAAC;MACtC,CAAC;AACDE,MAAAA,MAAM,EAAE,SAARA,MAAMA,GAAoB;QAAA,IAAAC,sBAAA,EAAAC,mBAAA;QACxB,IAAIjE,OAAO,KAAK,OAAO,EAAE;AACvBuB,UAAAA,iBAAiB,CAAC;AAChBnB,YAAAA,KAAK,EAAEgB,WAAW;YAClBK,QAAQ,EAAE,SAAVA,QAAQA,GAAA;cAAA,OACNvB,eAAe,CAAC,KAAK,EAAE;AAAEF,gBAAAA,OAAO,EAAE;AAAuB,eAAC,CAAC;AAAA,YAAA;AAC/D,WAAC,CAAC;AACJ,QAAA;AAAC,QAAA,KAAA,IAAAkE,KAAA,GAAA3I,SAAA,CAAAC,MAAA,EAPSqI,IAAI,GAAA,IAAA7C,KAAA,CAAAkD,KAAA,GAAAC,KAAA,GAAA,CAAA,EAAAA,KAAA,GAAAD,KAAA,EAAAC,KAAA,EAAA,EAAA;AAAJN,UAAAA,IAAI,CAAAM,KAAA,CAAA,GAAA5I,SAAA,CAAA4I,KAAA,CAAA;AAAA,QAAA;QAQd,CAAAH,sBAAA,GAAA,CAAAC,mBAAA,GAAAxB,WAAW,CAACnE,KAAK,EAACyF,MAAM,MAAA,IAAA,IAAAC,sBAAA,KAAA,KAAA,CAAA,IAAxBA,sBAAA,CAAAhC,IAAA,CAAA7F,KAAA,CAAA6H,sBAAA,EAAA,CAAAC,mBAAA,CAAA,CAAAzE,MAAA,CAA8BqE,IAAI,CAAA,CAAC;MACrC,CAAC;AACDO,MAAAA,aAAa,EAAE,SAAfA,aAAaA,CAAG7H,CAAa,EAAK;QAAA,IAAA8H,sBAAA,EAAAC,mBAAA;QAChC,IAAItE,OAAO,KAAK,cAAc,EAAE;UAC9BzD,CAAC,CAACgI,cAAc,EAAE;AAClBhD,UAAAA,iBAAiB,CAAC;AAChBnB,YAAAA,KAAK,EAAEgB,WAAW;YAClBK,QAAQ,EAAE,SAAVA,QAAQA,GAAA;cAAA,OACNvB,eAAe,CAAC,IAAI,EAAE;AAAE3D,gBAAAA,CAAC,EAADA,CAAC;AAAEyD,gBAAAA,OAAO,EAAE;AAAe,eAAC,CAAC;AAAA,YAAA;AACzD,WAAC,CAAC;AACJ,QAAA;AACA,QAAA,CAAAqE,sBAAA,GAAA,CAAAC,mBAAA,GAAA7B,WAAW,CAACnE,KAAK,EAAC8F,aAAa,cAAAC,sBAAA,KAAA,KAAA,CAAA,IAA/BA,sBAAA,CAAArC,IAAA,CAAAsC,mBAAA,EAAkC/H,CAAC,CAAC;MACtC,CAAC;AACDiI,MAAAA,SAAS,EAAE,SAAXA,SAASA,CAAGjI,CAAgB,EAAK;QAAA,IAAAkI,sBAAA,EAAAC,mBAAA;QAC/B,IAAI,CAAAnI,CAAC,KAAA,IAAA,IAADA,CAAC,KAAA,KAAA,CAAA,GAAA,KAAA,CAAA,GAADA,CAAC,CAAEoI,GAAG,MAAKhF,OAAO,EAAE;AACtB4B,UAAAA,iBAAiB,CAAC;AAChBnB,YAAAA,KAAK,EAAEkB,SAAS;YAChBG,QAAQ,EAAE,SAAVA,QAAQA,GAAA;cAAA,OACNvB,eAAe,CAAC,KAAK,EAAE;AAAE3D,gBAAAA,CAAC,EAADA,CAAC;AAAEyD,gBAAAA,OAAO,EAAE;AAAc,eAAC,CAAC;AAAA,YAAA;AACzD,WAAC,CAAC;AACJ,QAAA;AACA,QAAA,CAAAyE,sBAAA,GAAA,CAAAC,mBAAA,GAAAjC,WAAW,CAACnE,KAAK,EAACkG,SAAS,cAAAC,sBAAA,KAAA,KAAA,CAAA,IAA3BA,sBAAA,CAAAzC,IAAA,CAAA0C,mBAAA,EAA8BnI,CAAC,CAAC;AAClC,MAAA;KACD;AACD;AACA,IAAA,IAAI0B,UAAU,CAACwE,WAAW,CAAC,EAAE;MAC3BC,YAAY,CAAChI,GAAG,GAAGkK,WAAW,CAC5BzE,UAAU,EACVpB,UAAU,CAAC0D,WAAkB,CAC/B,CAAC;AACH,IAAA,CAAC,MAAM;AACL;AACAC,MAAAA,YAAY,CAAC,YAAY,CAAC,GAAGlC,cAAc,CAACnG,OAAO;AACrD,IAAA;AAEA,IAAA,OAAOqI,YAAY;AACrB,EAAA;;AAEA;EACA,SAASmC,cAAcA,CAACC,QAAyB,EAAE;IACjD,IAAMrC,WAAW,gBACf5D,cAAc,CAACiG,QAAQ,CAAC,IAAI,CAACjH,YAAU,CAACiH,QAAQ,CAAC,GAC7CA,QAAQ,gBACRC,KAAK,CAACC,aAAa,CAAC,MAAM,EAAE;AAAEF,MAAAA,QAAQ,EAARA;AAAS,KAAC,CAAC;IAE/C,oBAAOC,KAAK,CAACE,YAAY,CAACxC,WAAW,EAAED,eAAe,CAACC,WAAW,CAAC,CAAC;AACtE,EAAA;;AAEA;AACA,EAAA,IAAMyC,aAAa,GAAGC,WAAW,CAAC,YAAM;AACtC,IAAA,IAAI,OAAOhG,QAAQ,KAAK,WAAW,EAAE,OAAO,EAAE;IAC9C,OAAOA,QAAQ,CAACiG,aAAa,CAAA,gBAAA,CAAA5F,MAAA,CAAiBgB,cAAc,CAACnG,OAAO,EAAA,KAAA,CAAI,CAAC;EAC3E,CAAC,EAAE,EAAE,CAAC;EAEN,OAAO;AACLwK,IAAAA,cAAc,EAAdA,cAAc;AACd3C,IAAAA,aAAa,EAAbA,aAAa;AACbgD,IAAAA,aAAa,EAAbA;GACD;AACH;;ACzPA,IAAMG,eAA2B,GAAG,EAAE;AAUtC,IAAMC,WAAW,GAAG,SAAdA,WAAWA,CAAIC,OAA6B,EAAA;EAAA,OAChDA,OAAO,CAACC,MAAM,CACZ,UAACC,GAAG,EAAA5F,IAAA,EAAmB;AAAA,IAAA,IAAA2B,KAAA,GAAAxE,cAAA,CAAA6C,IAAA,EAAA,CAAA,CAAA;AAAhB8E,MAAAA,GAAG,GAAAnD,KAAA,CAAA,CAAA,CAAA;AAAE/G,MAAAA,KAAK,GAAA+G,KAAA,CAAA,CAAA,CAAA;AACfiE,IAAAA,GAAG,CAACd,GAAG,CAAC,GAAGlK,KAAK;AAChB,IAAA,OAAOgL,GAAG;EACZ,CAAC,EACD,EACF,CAAC;AAAA,CAAA;AAEH,IAAMC,SAAS,GAAG,SAAZA,SAASA,CACbC,gBAA2C,EAC3CC,aAA2B,EAEP;AAAA,EAAA,IADpBtK,OAAgB,GAAAC,SAAA,CAAAC,MAAA,GAAA,CAAA,IAAAD,SAAA,CAAA,CAAA,CAAA,KAAAE,SAAA,GAAAF,SAAA,CAAA,CAAA,CAAA,GAAG,EAAE;AAErB,EAAA,IAAMsK,WAAW,GAAGlL,MAAM,CAAgB,IAAI,CAAC;AAE/C,EAAA,IAAMmL,mBAAmB,GAAG;IAC1BC,aAAa,EAAEzK,OAAO,CAACyK,aAAa;AACpCC,IAAAA,SAAS,EAAE1K,OAAO,CAAC0K,SAAS,IAAI,QAAQ;AACxCC,IAAAA,QAAQ,EAAE3K,OAAO,CAAC2K,QAAQ,IAAI,UAAU;AACxCC,IAAAA,SAAS,EAAE5K,OAAO,CAAC4K,SAAS,IAAIb;GACjC;EAED,IAAAzI,SAAA,GAA0BC,QAAQ,CAAQ;AACxCsJ,MAAAA,MAAM,EAAE;AACNC,QAAAA,MAAM,EAAE;UACNC,QAAQ,EAAEP,mBAAmB,CAACG,QAAQ;AACtCK,UAAAA,IAAI,EAAE,GAAG;AACTC,UAAAA,GAAG,EAAE;SACN;AACDC,QAAAA,KAAK,EAAE;AACLH,UAAAA,QAAQ,EAAE;AACZ;OACD;AACDtL,MAAAA,UAAU,EAAE;AACd,KAAC,CAAC;IAAAgC,UAAA,GAAAC,cAAA,CAAAJ,SAAA,EAAA,CAAA,CAAA;AAZK6J,IAAAA,KAAK,GAAA1J,UAAA,CAAA,CAAA,CAAA;AAAE2J,IAAAA,QAAQ,GAAA3J,UAAA,CAAA,CAAA,CAAA;EActB,IAAM4J,mBAAmB,GAAG7F,OAAO,CACjC,YAAA;IAAA,OAAO;AACL8F,MAAAA,IAAI,EAAE,aAAa;AACnBC,MAAAA,OAAO,EAAE,IAAI;AACbC,MAAAA,KAAK,EAAE,OAAyB;AAChCC,MAAAA,EAAE,EAAE,SAAJA,EAAEA,CAAAC,KAAA,EAAyC;AAAA,QAAA,IAApCP,KAAK,GAAAO,KAAA,CAALP,KAAK;QACV,IAAMQ,QAAQ,GAAGC,MAAM,CAACC,IAAI,CAACV,KAAK,CAACQ,QAAQ,CAAC;AAE5CG,QAAAA,SAAS,CAAC,YAAM;AACdV,UAAAA,QAAQ,CAAC;YACPP,MAAM,EAAEb,WAAW,CACjB2B,QAAQ,CAACI,GAAG,CAAC,UAACjI,OAAO,EAAA;AAAA,cAAA,OAAK,CAACA,OAAO,EAAEqH,KAAK,CAACN,MAAM,CAAC/G,OAAO,CAAC,IAAI,EAAE,CAAC;AAAA,YAAA,CAAA,CAClE,CAAC;YACDrE,UAAU,EAAEuK,WAAW,CACrB2B,QAAQ,CAACI,GAAG,CAAC,UAACjI,OAAO,EAAA;cAAA,OAAK,CAACA,OAAO,EAAEqH,KAAK,CAAC1L,UAAU,CAACqE,OAAO,CAAC,CAAC;YAAA,CAAA,CAChE;AACF,WAAC,CAAC;AACJ,QAAA,CAAC,CAAC;MACJ,CAAC;MACDkI,QAAQ,EAAE,CAAC,eAAe;KAC3B;EAAA,CAAC,EACF,EACF,CAAC;AAED,EAAA,IAAMC,aAAa,GAAGzG,OAAO,CAAC,YAAM;AAClC,IAAA,IAAM0G,UAAU,GAAG;MACjBzB,aAAa,EAAED,mBAAmB,CAACC,aAAa;MAChDC,SAAS,EAAEF,mBAAmB,CAACE,SAAS;MACxCC,QAAQ,EAAEH,mBAAmB,CAACG,QAAQ;MACtCC,SAAS,EAAA,EAAA,CAAA1G,MAAA,CAAAiI,kBAAA,CACJ3B,mBAAmB,CAACI,SAAS,CAAA,EAAA,CAChCS,mBAAmB,EACnB;AACEC,QAAAA,IAAI,EAAE,aAAa;AACnBC,QAAAA,OAAO,EAAE,KAAK;AACdC,QAAAA,KAAK,EAAE;OACR,CAAA;KAEJ;IAED,IAAIjL,SAAO,CAACgK,WAAW,CAACxL,OAAO,EAAEmN,UAAU,CAAC,EAAE;AAC5C,MAAA,OAAO3B,WAAW,CAACxL,OAAO,IAAImN,UAAU;AAC1C,IAAA;IACA3B,WAAW,CAACxL,OAAO,GAAGmN,UAAU;AAChC,IAAA,OAAOA,UAAU;EACnB,CAAC,EAAE,CACD1B,mBAAmB,CAACC,aAAa,EACjCD,mBAAmB,CAACE,SAAS,EAC7BF,mBAAmB,CAACG,QAAQ,EAC5BH,mBAAmB,CAACI,SAAS,EAC7BS,mBAAmB,CACpB,CAAC;AAEF,EAAA,IAAMe,iBAAiB,GAAG/M,MAAM,CAAwB,IAAI,CAAC;AAE7DgN,EAAAA,yBAAyB,CAAC,YAAM;IAC9B,IAAID,iBAAiB,CAACrN,OAAO,EAAE;AAC7BqN,MAAAA,iBAAiB,CAACrN,OAAO,CAACuN,UAAU,CAACL,aAAa,CAAC;AACrD,IAAA;AACF,EAAA,CAAC,EAAE,CAACA,aAAa,CAAC,CAAC;AAEnBI,EAAAA,yBAAyB,CAAC,YAAM;AAC9B,IAAA,IAAIhC,gBAAgB,IAAI,IAAI,IAAIC,aAAa,IAAI,IAAI,EAAE;AACrD,MAAA;AACF,IAAA;AAEA,IAAA,IAAMiC,cAAY,GAAGvM,OAAO,CAACuM,YAAY,IAAIC,YAAmB;IAChE,IAAMC,cAAc,GAAGF,cAAY,CACjClC,gBAAgB,EAChBC,aAAa,EACb2B,aACF,CAAC;IAEDG,iBAAiB,CAACrN,OAAO,GAAG0N,cAAc;AAE1C,IAAA,OAAO,YAAM;MACXA,cAAc,CAACC,OAAO,EAAE;MACxBN,iBAAiB,CAACrN,OAAO,GAAG,IAAI;IAClC,CAAC;EACH,CAAC,EAAE,CAACsL,gBAAgB,EAAEC,aAAa,EAAEtK,OAAO,CAACuM,YAAY,CAAC,CAAC;EAE3D,OAAO;IACLpB,KAAK,EAAEiB,iBAAiB,CAACrN,OAAO,GAC5BqN,iBAAiB,CAACrN,OAAO,CAACoM,KAAK,GAC/BhL,SAAS;IACb0K,MAAM,EAAEM,KAAK,CAACN,MAAM;IACpBpL,UAAU,EAAE0L,KAAK,CAAC1L,UAAU;IAC5BkN,MAAM,EAAEP,iBAAiB,CAACrN,OAAO,GAAGqN,iBAAiB,CAACrN,OAAO,CAAC4N,MAAM,GAAG,IAAI;IAC3EC,WAAW,EAAER,iBAAiB,CAACrN,OAAO,GAClCqN,iBAAiB,CAACrN,OAAO,CAAC6N,WAAW,GACrC;GACL;AACH,CAAC;;ACrLD;AACA;AACA;;AAIO,IAAMC,iBAA+B,GAAG;AAC7CC,EAAAA,cAAc,EAAE,KAAK;AACrBC,EAAAA,cAAc,EAAE,KAAK;AACrBrC,EAAAA,SAAS,EAAE,KAAK;AAChBsC,EAAAA,SAAS,EAAE,KAAK;AAChBtI,EAAAA,OAAO,EAAE;AACX,CAAC;;;;;ACiCD,IAAMuI,KAAK,gBAAGC,UAAU,CAAuB,UAACC,aAAa,EAAE/N,GAAG,EAAK;AAAA,EAAA,IAAAgO,qBAAA;AACrE,EAAA,IAAMpK,KAAK,GAAGqK,eAAe,CAAaF,aAAa,EAAEN,iBAAiB,CAAC;AAC3E,EAAA,IAAAS,UAAA,GAAwBC,SAAS,EAAE;IAA3BC,WAAW,GAAAF,UAAA,CAAXE,WAAW;AACnB,EAAA,IACE9I,OAAO,GAkBL1B,KAAK,CAlBP0B,OAAO;IACPF,OAAO,GAiBLxB,KAAK,CAjBPwB,OAAO;IACPkG,SAAS,GAgBP1H,KAAK,CAhBP0H,SAAS;IACTsC,SAAS,GAePhK,KAAK,CAfPgK,SAAS;IACTF,cAAc,GAcZ9J,KAAK,CAdP8J,cAAc;IACdW,gBAAgB,GAadzK,KAAK,CAbPyK,gBAAgB;IAChBC,qBAAqB,GAYnB1K,KAAK,CAZP0K,qBAAqB;IACrBC,YAAY,GAWV3K,KAAK,CAXP2K,YAAY;IACZC,iBAAiB,GAUf5K,KAAK,CAVP4K,iBAAiB;IACjBC,cAAc,GASZ7K,KAAK,CATP6K,cAAc;IAAAC,eAAA,GASZ9K,KAAK,CARPwG,QAAQ;AAARA,IAAAA,QAAQ,GAAAsE,eAAA,KAAA,KAAA,CAAA,GAAGD,cAAc,GAAAC,eAAA;IACzBrJ,QAAQ,GAONzB,KAAK,CAPPyB,QAAQ;IACRsJ,MAAM,GAMJ/K,KAAK,CANP+K,MAAM;IACNC,QAAQ,GAKNhL,KAAK,CALPgL,QAAQ;IACRC,gBAAgB,GAIdjL,KAAK,CAJPiL,gBAAgB;IAChBnJ,KAAK,GAGH9B,KAAK,CAHP8B,KAAK;IACLiI,cAAc,GAEZ/J,KAAK,CAFP+J,cAAc;IACdmB,eAAe,GACblL,KAAK,CADPkL,eAAe;;AAGjB;AACA,EAAA,IAAAC,cAAA,GAAqD9M,aAAa,EAAE;IAApD+M,YAAY,GAAAD,cAAA,CAApBE,MAAM;IAAuBC,WAAW,GAAAH,cAAA,CAAlBI,KAAK;EACnC,IAAAC,cAAA,GAAmCC,aAAa,CAC9CzL,KAAK,EACL,SAAS,EACTA,KAAK,CAAC4B,eACR,CAAC;IAAA8J,eAAA,GAAAhN,cAAA,CAAA8M,cAAA,EAAA,CAAA,CAAA;AAJM7J,IAAAA,OAAO,GAAA+J,eAAA,CAAA,CAAA,CAAA;AAAE9J,IAAAA,eAAe,GAAA8J,eAAA,CAAA,CAAA,CAAA;AAK/B;AACA;AACA,EAAA,IAAApN,SAAA,GAAwCC,QAAQ,CAAC,IAAI,CAAC;IAAAE,UAAA,GAAAC,cAAA,CAAAJ,SAAA,EAAA,CAAA,CAAA;AAA/CqN,IAAAA,YAAY,GAAAlN,UAAA,CAAA,CAAA,CAAA;AAAEmN,IAAAA,eAAe,GAAAnN,UAAA,CAAA,CAAA,CAAA;AACpC,EAAA,IAAMoD,UAAU,GAAGxF,MAAM,CAAC,IAAI,CAAC,CAAC;AAChC,EAAA,IAAMwP,QAAQ,GAAGxP,MAAM,CAAC,IAAI,CAAC,CAAC;AAC9B,EAAA,IAAMyP,SAAS,GAAGzP,MAAM,CAAC,IAAI,CAAC,CAAC;AAC/B,EAAA,IAAM0P,UAAU,GAAG1P,MAAM,CAAC,IAAI,CAAC,CAAC;AAChC,EAAA,IAAM2P,SAAS,GAAG3P,MAAM,CAAsC,IAAI,CAAC,CAAC;;AAEpE;EACA,IAAM4P,0BAA0B,GAAG,GAAG;;AAEtC;AACAzO,EAAAA,SAAS,CAAC,YAAM;AACd,IAAA,IAAI,CAACgE,OAAO,IAAIuI,cAAc,EAAE;AAC9BmC,MAAAA,qBAAqB,CAAC,YAAA;QAAA,OAAMN,eAAe,CAAC,IAAI,CAAC;MAAA,CAAA,CAAC;AACpD,IAAA;AACF,EAAA,CAAC,EAAE,CAACpK,OAAO,EAAEuI,cAAc,CAAC,CAAC;;AAE7B;AACA,EAAA,IAAMoC,WAAW,GAAG3J,OAAO,CAAC,YAAM;AAChC,IAAA,IAAIuH,cAAc,IAAI,CAACvI,OAAO,EAAE,OAAO,KAAK;IAC5C,OAAOG,OAAO,IAAIgK,YAAY;EAChC,CAAC,EAAE,CAAC5B,cAAc,EAAEvI,OAAO,EAAEG,OAAO,EAAEgK,YAAY,CAAC,CAAC;;AAEpD;EACA,IAAMS,eAAe,GAAG5J,OAAO,CAC7B,YAAA;AAAA,IAAA,OACEkF,SAAS,IACRA,SAAS,CACP2E,OAAO,CAAC,cAAc,EAAE,QAAQ,CAAC,CACjCA,OAAO,CAAC,kBAAkB,EAAE,MAAM,CAAe;EAAA,CAAA,EACtD,CAAC3E,SAAS,CACZ,CAAC;AACD;EACA,IAAA4E,WAAA,GAAyDhL,UAAU,CAAC;AAClEO,MAAAA,UAAU,EAAVA,UAAU;AACVL,MAAAA,OAAO,EAAPA,OAAO;AACPC,MAAAA,QAAQ,EAARA,QAAQ;AACRC,MAAAA,OAAO,EAAPA,OAAO;AACPC,MAAAA,OAAO,EAAPA,OAAO;AACPG,MAAAA,KAAK,EAALA,KAAK;AACLF,MAAAA,eAAe,EAAfA;AACF,KAAC,CAAC;IARM2E,cAAc,GAAA+F,WAAA,CAAd/F,cAAc;IAAE3C,aAAa,GAAA0I,WAAA,CAAb1I,aAAa;IAAEgD,aAAa,GAAA0F,WAAA,CAAb1F,aAAa;AASpD;AACA,EAAA,IAAMqC,aAAa,GAAGjJ,KAAK,CAACiJ,aAAwB;AACpD,EAAA,IAAA1H,IAAA,GAAsD0H,aAAa,IAAI,EAAE;IAAtDsD,QAAQ,GAAAhL,IAAA,CAAnBmG,SAAS;AAAe8E,IAAAA,iBAAiB,GAAAC,wBAAA,CAAAlL,IAAA,EAAAmL,SAAA,CAAA;;AAEjD;AACAV,EAAAA,SAAS,CAACjQ,OAAO,GAAGqL,SAAS,CAACvL,WAAS,CAACgG,UAAU,CAAC,EAAE8J,YAAY,EAAAgB,aAAA,CAAA;AAC/DjF,IAAAA,SAAS,EAAE0E;GAA4B,EACpCI,iBAAiB,CACrB,CAAC;;AAEF;AACA,EAAA,IAAMI,gBAAgB,GAAG3D,aAAa,aAAbA,aAAa,KAAA,KAAA,CAAA,IAAA,CAAAmB,qBAAA,GAAbnB,aAAa,CAAErB,SAAS,MAAA,IAAA,IAAAwC,qBAAA,KAAA,KAAA,CAAA,GAAA,KAAA,CAAA,GAAxBA,qBAAA,CAA0ByC,IAAI,CACrD,UAACC,QAAQ,EAAA;AAAA,IAAA,OAAKA,QAAQ,CAACxE,IAAI,KAAK,OAAO;AAAA,EAAA,CACzC,CAAC;AACD,EAAA,IAAAyE,kBAAA,GAA+Bf,SAAS,CAACjQ,OAAO;IAAxC8L,MAAM,GAAAkF,kBAAA,CAANlF,MAAM;IAAEpL,UAAU,GAAAsQ,kBAAA,CAAVtQ,UAAU;AAC1B;AACA;AACA;EACA,IAAM0H,WAAW,GAAG6I,UAAU,CAACxG,QAAQ,CAAC,GACpCD,cAAc,CAACC,QAAQ,CAAC;AAAE7E,IAAAA,OAAO,EAAPA;AAAQ,GAAC,CAAC,CAAC,GACrC4E,cAAc,CAACC,QAAQ,CAAC;AAE5B,EAAA,IAAMyG,aAAa,GAAG5Q,MAAM,CAAC,IAAI,CAAC;AAClC;AACA6Q,EAAAA,qBAAmB,CAACrR,WAAS,CAACgG,UAAU,CAAC,EAAE,YAAM;AAC/C,IAAA,IAAMsL,aAAa,GACjBC,eAAe,CAAC,SAAS,EAAEvR,WAAS,CAACgG,UAAU,CAAC,CAAC,KAAK,MAAM;AAC9D,IAAA,IAAIF,OAAO,IAAI,CAACwL,aAAa,EAAE;AAC7B/J,MAAAA,YAAY,CAAC6J,aAAa,CAAClR,OAAc,CAAC;AAC1CkR,MAAAA,aAAa,CAAClR,OAAO,GAAGsH,UAAU,CAChC,YAAA;QAAA,IAAAgK,mBAAA,EAAAC,qBAAA;QAAA,OAAA,CAAAD,mBAAA,GAAMrB,SAAS,CAACjQ,OAAO,MAAA,IAAA,IAAAsR,mBAAA,gBAAAC,qBAAA,GAAjBD,mBAAA,CAAmB1D,MAAM,cAAA2D,qBAAA,KAAA,KAAA,CAAA,GAAA,KAAA,CAAA,GAAzBA,qBAAA,CAAA5J,IAAA,CAAA2J,mBAA4B,CAAC;AAAA,MAAA,CAAA,EACnC,CACF,CAAQ;AACV,IAAA;AACF,EAAA,CAAC,CAAC;AACF;AACA7P,EAAAA,SAAS,CAAC,YAAA;IAAA,OAAM,YAAA;AAAA,MAAA,OAAM4F,YAAY,CAAC6J,aAAa,CAAClR,OAAc,CAAC;AAAA,IAAA,CAAA;AAAA,EAAA,CAAA,EAAE,EAAE,CAAC;;AAErE;AACAyB,EAAAA,SAAS,CAAC,YAAM;AACd,IAAA,IAAImE,OAAO,EAAE;AACXuK,MAAAA,qBAAqB,CAAC,YAAA;QAAA,IAAAqB,mBAAA,EAAAC,qBAAA;QAAA,OAAA,CAAAD,mBAAA,GAAMvB,SAAS,CAACjQ,OAAO,MAAA,IAAA,IAAAwR,mBAAA,gBAAAC,qBAAA,GAAjBD,mBAAA,CAAmB5D,MAAM,cAAA6D,qBAAA,KAAA,KAAA,CAAA,GAAA,KAAA,CAAA,GAAzBA,qBAAA,CAAA9J,IAAA,CAAA6J,mBAA4B,CAAC;MAAA,CAAA,CAAC;AAC5D,IAAA;EACF,CAAC,EAAE,CAAC5L,OAAO,EAAEH,OAAO,EAAE4J,YAAY,EAAEE,WAAW,CAAC,CAAC;;AAEjD;AACA9N,EAAAA,SAAS,CAAC,YAAM;IACd,IAAI,CAACqE,UAAU,CAAC9F,OAAO,EAAE8F,UAAU,CAAC9F,OAAO,GAAG6K,aAAa,EAAS;AACpE,IAAA,IAAIjF,OAAO,EAAE;MACXuJ,eAAe,KAAA,IAAA,IAAfA,eAAe,KAAA,KAAA,CAAA,IAAfA,eAAe,CAAGa,UAAU,CAAChQ,OAAc,CAAC;AAC9C,IAAA;EACF,CAAC,EAAE,CAAC4F,OAAO,EAAEuJ,eAAe,EAAEtE,aAAa,CAAC,CAAC;EAE7C,SAAS6G,YAAYA,GAAG;IACtB,CAAC3D,cAAc,IACb6B,YAAY,KACVA,YAAY,CAAiB+B,KAAK,CAACC,OAAO,GAAG,MAAM,CAAC;AAC1D,EAAA;EACA,SAASC,WAAWA,GAAG;IACrB,CAAC9D,cAAc,IACb6B,YAAY,KACVA,YAAY,CAAiB+B,KAAK,CAACC,OAAO,GAAG,OAAO,CAAC;AAC3D,EAAA;EAEA,SAASE,YAAYA,CAAC5P,CAAmC,EAAE;AACzD+M,IAAAA,QAAQ,KAAA,IAAA,IAARA,QAAQ,KAAA,KAAA,CAAA,IAARA,QAAQ,CAAG;AAAE/M,MAAAA,CAAC,EAADA;AAAE,KAAC,CAAC;;AAEjB;AACA,IAAA,IAAM6P,sBAAsB,GAAG/P,QAAQ,CACrC,UAACE,CAAC,EAAA;AAAA,MAAA,OAAKgN,gBAAgB,KAAA,IAAA,IAAhBA,gBAAgB,KAAA,KAAA,CAAA,GAAA,KAAA,CAAA,GAAhBA,gBAAgB,CAAG;AAAEhN,QAAAA,CAAC,EAADA;AAAE,OAAC,CAAC;AAAA,IAAA,CAAA,EAChC,GACF,CAAC;AAED,IAAA,IAAAiF,KAAA,GACEjF,CAAC,CAAC0F,MAAM;MADFoK,SAAS,GAAA7K,KAAA,CAAT6K,SAAS;MAAEC,YAAY,GAAA9K,KAAA,CAAZ8K,YAAY;MAAEC,YAAY,GAAA/K,KAAA,CAAZ+K,YAAY;AAE7C;IACA,IAAID,YAAY,GAAG7L,IAAI,CAAC+L,KAAK,CAACH,SAAS,CAAC,KAAKE,YAAY,EAAE;AACzD;MACAH,sBAAsB,CAAC7P,CAAC,CAAC;AAC3B,IAAA;AACF,EAAA;;AAEA;EACA,SAASkQ,eAAeA,CAACxD,YAA0C,EAAE;AACnE,IAAA,IACE9O,WAAS,CAACgG,UAAU,CAAC,IACrBgK,QAAQ,CAAC9P,OAAO,IAChB,OAAO4O,YAAY,KAAK,UAAU,EAClC;AACA,MAAA,OAAAgC,aAAA,CAAA,EAAA,EAAYhC,YAAY,CAAC9O,WAAS,CAACgG,UAAU,CAAC,EAAEgK,QAAQ,CAAC9P,OAAO,CAAC,CAAA;AACnE,IAAA;IACA,OAAA4Q,aAAA,KAAYhC,YAAY,CAAA;AAC1B,EAAA;EAEA,IAAMyD,OAAO,GAAGjC,WAAW,iBACzB1F,KAAA,CAAAC,aAAA,CAAC2H,aAAa,EAAA;IACZC,MAAM,EAAA,IAAA;AACN,IAAA,IAAA,EAAI3M,OAAQ;AACZ4M,IAAAA,OAAO,EAAEtC,0BAA2B;AACpCuC,IAAAA,OAAO,EAAE1C,SAAU;AACnB2C,IAAAA,aAAa,EAAE3E,cAAe;AAC9B4E,IAAAA,OAAO,EAAEd,WAAY;AACrBe,IAAAA,QAAQ,EAAElB,YAAa;IACvBnJ,UAAU,EAAA,EAAA,CAAApD,MAAA,CAAKsJ,WAAW,EAAA,SAAA;AAAU,GAAA,eAEpC/D,KAAA,CAAAC,aAAA,CAACkI,MAAM,EAAA;AAACzK,IAAAA,WAAW,EAAEtI,WAAS,CAACgG,UAAU,CAAE;AAACgN,IAAAA,MAAM,EAAC,MAAM;AAACzS,IAAAA,GAAG,EAAE0P;AAAU,GAAA,eACvErF,KAAA,CAAAC,aAAA,CAAC2H,aAAa,EAAA;IACZC,MAAM,EAAA,IAAA;AACNC,IAAAA,OAAO,EAAE,CAAE;AACX,IAAA,IAAA,EAAI5M,OAAQ;AACZ6M,IAAAA,OAAO,EAAE3C,QAAS;IAClBvH,UAAU,EAAA,EAAA,CAAApD,MAAA,CAAKsJ,WAAW,EAAA,QAAA;AAAS,GAAA,eAEnC/D,KAAA,CAAAC,aAAA,CAAA,KAAA,EAAAoI,QAAA,CAAA;AACE1S,IAAAA,GAAG,EAAE,SAALA,GAAGA,CAAGkE,IAAI,EAAK;AACb,MAAA,IAAIA,IAAI,EAAE;QACRuL,QAAQ,CAAC9P,OAAO,GAAGuE,IAAW;QAC9BsL,eAAe,CAACtL,IAAW,CAAC;AAC9B,MAAA;IACF,CAAE;AACFoN,IAAAA,KAAK,EAAAf,aAAA,CAAAA,aAAA,CAAA,EAAA,EACC9E,MAAM,CAASC,MAAM,CAAA,EAAA,EAAA,EAAA;AACzBiD,MAAAA,MAAM,EAANA;AAAM,KAAA,EACHoD,eAAe,CAACxD,YAAY,CAAC,CAChC;IACFtG,SAAS,EAAEC,UAAU,CAAA,EAAA,CAAApD,MAAA,CAAIsJ,WAAW,EAAA,QAAA,CAAA,EAAUC,gBAAgB,EAAE,EAAE;GAAE,EAChEhO,UAAU,CAACqL,MAAM,EACjBlE,aAAa,EAAE,CAAA,eAEnB6C,KAAA,CAAAC,aAAA,CAAA,KAAA,EAAA;AACEtK,IAAAA,GAAG,EAAE2P,UAAW;AAChB1H,IAAAA,SAAS,EAAEC,UAAU,CAAA,EAAA,CAAApD,MAAA,CAChBsJ,WAAW,EAAA,iBAAA,CAAA,EAAAuE,eAAA,CAAA,EAAA,EAAA,EAAA,CAAA7N,MAAA,CAERsJ,WAAW,EAAA,wBAAA,CAAA,EAA2BR,SAAS,CAAA,EAErDU,qBACF,CAAE;AACFgD,IAAAA,KAAK,EAAES,eAAe,CAACvD,iBAAiB,CAAE;AAC1CI,IAAAA,QAAQ,EAAE6C;GAAa,EAEtBrM,OAAO,EACPwI,SAAS,iBACRvD,KAAA,CAAAC,aAAA,QAAAoI,QAAA,CAAA;IACEpB,KAAK,EAAG7F,MAAM,CAASK,KAAM;IAC7B7D,SAAS,EAAA,EAAA,CAAAnD,MAAA,CAAKsJ,WAAW,EAAA,eAAA;AAAgB,GAAA,EACpCoC,gBAAgB,IAAI;AAAE,IAAA,mBAAmB,EAAE;AAAG,GAAC,CACrD,CAEA,CACF,CACQ,CACT,CACK,CAChB;AACD;AACA;AACA;AACA;EACAoC,mBAAmB,CAAC5S,GAAG,EAAE,YAAA;IAAA,OAAO;MAC9B6S,SAAS,EAAE,SAAXA,SAASA,GAAA;QAAA,OAAQjD,SAAS,CAACjQ,OAAO;MAAA,CAAO;MACzCmT,eAAe,EAAE,SAAjBA,eAAeA,GAAA;QAAA,OAAQrD,QAAQ,CAAC9P,OAAO;MAAA,CAAO;MAC9CoT,gBAAgB,EAAE,SAAlBA,gBAAgBA,GAAA;QAAA,OAAQrD,SAAS,CAAC/P,OAAO;MAAA,CAAO;MAChDqT,sBAAsB,EAAE,SAAxBA,sBAAsBA,GAAA;QAAA,OAAQrD,UAAU,CAAChQ,OAAO;MAAA,CAAO;AACvDsT,MAAAA,UAAU,EAAE,SAAZA,UAAUA,CAAG1N,OAAgB,EAAA;QAAA,OAC3BC,eAAe,CAACD,OAAO,EAAE;AAAED,UAAAA,OAAO,EAAE;AAAW,SAAC,CAAC;AAAA,MAAA;KACpD;AAAA,EAAA,CAAC,CAAC;AACH;AACA;EACA,oBACE+E,KAAA,CAAAC,aAAA,CAACD,KAAK,CAAC6I,QAAQ,EAAA,IAAA,EACZnL,WAAW,EACXiK,OACa,CAAC;AAErB,CAAC;AAEDnE,KAAK,CAACsF,WAAW,GAAG,OAAO;;;;"}