{"version":3,"file":"plugin.js","sources":["../../../components/utils/react-render.ts","../../../components/dialog/plugin.tsx"],"sourcesContent":["// Implementation reference from: https://github.com/react-component/util/blob/master/src/React/render.ts\r\n// @ts-ignore\r\nimport type * as React from 'react';\r\nimport * as ReactDOM from 'react-dom';\r\nimport type { Root } from 'react-dom/client';\r\n\r\n// Let compiler not to search module usage\r\nconst fullClone = {\r\n  ...ReactDOM,\r\n} as typeof ReactDOM & {\r\n  __SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED?: {\r\n    usingClientEntryPoint?: boolean;\r\n  };\r\n  createRoot?: CreateRoot;\r\n};\r\n\r\ntype CreateRoot = (container: ContainerType) => Root;\r\n\r\n// @ts-ignore\r\nconst { version, render: reactRender, unmountComponentAtNode } = fullClone;\r\n\r\nlet legacyCreateRoot: CreateRoot;\r\ntry {\r\n  const mainVersion = Number((version || '').split('.')[0]);\r\n  if (mainVersion >= 18 && mainVersion < 19) {\r\n    legacyCreateRoot = fullClone.createRoot;\r\n  }\r\n  if (process.env.NODE_ENV !== 'production' && mainVersion >= 19) {\r\n    console.warn(\r\n      'TDesign warning: Please import react-19-adapter in React 19, See link: https://github.com/Tencent/tdesign-react/blob/develop/packages/tdesign-react/site/docs/getting-started.md#如何在-react-19-中使用',\r\n    );\r\n  }\r\n} catch (e) {\r\n  // Do nothing;\r\n}\r\n\r\nfunction toggleWarning(skip: boolean) {\r\n  const { __SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED } = fullClone;\r\n\r\n  if (\r\n    __SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED &&\r\n    typeof __SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED === 'object'\r\n  ) {\r\n    __SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.usingClientEntryPoint =\r\n      skip;\r\n  }\r\n}\r\n\r\nconst MARK = '__td_react_root__';\r\n\r\n// ========================== Render ==========================\r\ntype ContainerType = (Element | DocumentFragment) & {\r\n  [MARK]?: Root;\r\n};\r\n\r\nfunction modernRender(node: React.ReactElement, container: ContainerType) {\r\n  toggleWarning(true);\r\n  const root = container[MARK] || legacyCreateRoot(container);\r\n  toggleWarning(false);\r\n\r\n  root.render(node);\r\n\r\n  // eslint-disable-next-line\r\n  container[MARK] = root;\r\n}\r\n\r\nfunction legacyRender(node: React.ReactElement, container: ContainerType) {\r\n  reactRender(node, container);\r\n}\r\n\r\nexport function render(node: React.ReactElement, container: ContainerType) {\r\n  if (legacyCreateRoot) {\r\n    modernRender(node, container);\r\n    return;\r\n  }\r\n\r\n  legacyRender?.(node, container);\r\n}\r\n\r\n// ========================= Unmount ==========================\r\nasync function modernUnmount(container: ContainerType) {\r\n  // Delay to unmount to avoid React 18 sync warning\r\n  return Promise.resolve().then(() => {\r\n    container[MARK]?.unmount();\r\n\r\n    // eslint-disable-next-line\r\n    delete container[MARK];\r\n  });\r\n}\r\n\r\nfunction legacyUnmount(container: ContainerType) {\r\n  unmountComponentAtNode(container);\r\n}\r\n\r\nexport async function unmount(container: ContainerType) {\r\n  if (legacyCreateRoot !== undefined) {\r\n    // Delay to unmount to avoid React 18 sync warning\r\n    return modernUnmount(container);\r\n  }\r\n\r\n  legacyUnmount(container);\r\n}\r\n\r\n/**\r\n * @deprecated Set React render function for compatible usage.\r\n * This is internal usage only compatible with React 19.\r\n * And will be removed in next major version.\r\n */\r\nexport function renderAdapter(render?: CreateRoot) {\r\n  if (render) {\r\n    legacyCreateRoot = render;\r\n  }\r\n}\r\n","import React from 'react';\r\nimport { render } from \"../utils/react-render\";\r\nimport DialogComponent, { DialogProps } from \"./Dialog\";\r\nimport { getAttach } from '../utils/dom';\r\nimport { DialogOptions, DialogMethod, DialogConfirmMethod, DialogAlertMethod, DialogInstance } from './type';\r\nimport PluginContainer from '../common/PluginContainer';\r\nimport ConfigProvider from '../config-provider';\r\n\r\nexport interface DialogPluginType extends DialogMethod {\r\n    alert: DialogAlertMethod;\r\n    confirm: DialogConfirmMethod;\r\n}\r\n\r\n\r\nconst createDialog: DialogPluginType = (props: DialogOptions): DialogInstance => {\r\n    const dialogRef = React.createRef<DialogInstance>();\r\n    const options = { ...props };\r\n    const { visible = true } = options;\r\n\r\n    const fragment = document.createDocumentFragment();\r\n\r\n    const dGlobalConfig = ConfigProvider.getGlobalConfig();\r\n    render(<PluginContainer globalConfig={dGlobalConfig}><DialogComponent {...(options as DialogProps)} visible={visible} ref={dialogRef} isPlugin /></PluginContainer>, fragment); const container = getAttach(options.attach);\r\n\r\n    if (container) {\r\n        container.appendChild(fragment);\r\n    } else {\r\n        console.error('Dialog', 'attach is not exist');\r\n    }\r\n\r\n    const dialogNode: DialogInstance = {\r\n        show: () => {\r\n            requestAnimationFrame(() => {\r\n                container?.appendChild(fragment);\r\n                dialogRef.current?.show();\r\n            });\r\n        },\r\n        hide: () => {\r\n            requestAnimationFrame(() => {\r\n                dialogRef.current?.destroy();\r\n            });\r\n        },\r\n        setConfirmLoading: (loading: boolean) => {\r\n            requestAnimationFrame(() => {\r\n                dialogRef.current?.setConfirmLoading(loading);\r\n            });\r\n        },\r\n        update: (updateOptions: DialogOptions) => {\r\n            requestAnimationFrame(() => {\r\n                dialogRef.current?.update(updateOptions);\r\n            });\r\n        },\r\n        destroy: () => {\r\n            requestAnimationFrame(() => {\r\n                dialogRef.current?.destroy();\r\n            });\r\n        },\r\n    };\r\n    return dialogNode;\r\n};\r\n\r\nconst confirm: DialogConfirmMethod = (props: DialogOptions) => createDialog(props);\r\n\r\nconst alert: DialogAlertMethod = (props: Omit<DialogOptions, 'confirmBtn'>) => {\r\n    const options = { ...props };\r\n    options.cancelBtn = null;\r\n    return createDialog(options);\r\n};\r\n\r\ncreateDialog.alert = alert;\r\ncreateDialog.confirm = confirm;\r\n\r\nexport const DialogPlugin = createDialog;\r\n\r\n"],"names":["fullClone","_objectSpread","ReactDOM","version","reactRender","render","unmountComponentAtNode","legacyCreateRoot","mainVersion","Number","split","createRoot","process","env","NODE_ENV","console","warn","e","toggleWarning","skip","__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED","_typeof","usingClientEntryPoint","MARK","modernRender","node","container","root","legacyRender","modernUnmount","_x","_modernUnmount","apply","arguments","_asyncToGenerator","_regeneratorRuntime","mark","_callee","wrap","_context","prev","next","abrupt","Promise","resolve","then","_container$MARK","unmount","stop","legacyUnmount","_x2","_unmount","_callee2","_context2","undefined","renderAdapter","createDialog","props","dialogRef","React","createRef","options","_options$visible","visible","fragment","document","createDocumentFragment","dGlobalConfig","ConfigProvider","getGlobalConfig","createElement","PluginContainer","globalConfig","DialogComponent","_extends","ref","isPlugin","getAttach","attach","appendChild","error","dialogNode","show","requestAnimationFrame","_dialogRef$current","current","hide","_dialogRef$current2","destroy","setConfirmLoading","loading","_dialogRef$current3","update","updateOptions","_dialogRef$current4","_dialogRef$current5","confirm","alert","cancelBtn","DialogPlugin"],"mappings":"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"}