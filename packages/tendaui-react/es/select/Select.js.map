{"version":3,"file":"Select.js","sources":["../../../components/select/hooks/useOptions.ts","../../../components/select/Select.tsx"],"sourcesContent":["import React, { useState, useEffect, ReactNode, ReactElement } from 'react';\r\nimport { get } from 'lodash-es';\r\nimport type {\r\n  SelectKeysType,\r\n  SelectOption,\r\n  SelectOptionGroup,\r\n  SelectValue,\r\n  TdOptionProps,\r\n} from '../type';\r\nimport { getValueToOption, type ValueToOption } from '../utils/helper';\r\nimport Option from '../Option';\r\nimport OptionGroup from '../OptionGroup';\r\n\r\nexport function isSelectOptionGroup(\r\n  option: SelectOption,\r\n): option is SelectOptionGroup {\r\n  return !!option && 'group' in option && 'children' in option;\r\n}\r\n\r\ntype OptionValueType = SelectValue<SelectOption>;\r\n\r\n// 处理 options 的逻辑\r\nfunction UseOptions(\r\n  keys: SelectKeysType,\r\n  options: SelectOption[],\r\n  children: ReactNode,\r\n  valueType: 'object' | 'value',\r\n  value: OptionValueType,\r\n  reserveKeyword: boolean,\r\n) {\r\n  const [valueToOption, setValueToOption] = useState<ValueToOption>({});\r\n  const [currentOptions, setCurrentOptions] = useState<SelectOption[]>([]);\r\n  const [tmpPropOptions, setTmpPropOptions] = useState<SelectOption[]>([]);\r\n  const [selectedOptions, setSelectedOptions] = useState<SelectOption[]>([]);\r\n\r\n  // 处理设置 option 的逻辑\r\n  useEffect(() => {\r\n    let transformedOptions = options;\r\n\r\n    const arrayChildren = React.Children.toArray(children);\r\n    const optionChildren = arrayChildren.filter(\r\n      (v: ReactElement) => v.type === Option || v.type === OptionGroup,\r\n    );\r\n    const isChildrenFilterable =\r\n      arrayChildren.length > 0 &&\r\n      optionChildren.length === arrayChildren.length;\r\n    if (reserveKeyword && currentOptions.length && isChildrenFilterable) return;\r\n\r\n    if (isChildrenFilterable) {\r\n      const handlerOptionElement = (v) => {\r\n        if (React.isValidElement<SelectOption>(v)) {\r\n          if (v.type === OptionGroup) {\r\n            return {\r\n              ...v.props,\r\n              group: v.props.label,\r\n              children: v.props.children?.map((v) => handlerOptionElement(v)),\r\n            };\r\n          }\r\n          return {\r\n            ...v.props,\r\n            label: v.props.label || v.props.children,\r\n          };\r\n        }\r\n        return { label: v };\r\n      };\r\n      transformedOptions = arrayChildren?.map<SelectOption>((v) =>\r\n        handlerOptionElement(v),\r\n      );\r\n    }\r\n    if (keys) {\r\n      // 如果有定制 keys 先做转换\r\n      transformedOptions = transformedOptions?.map<SelectOption>((option) => ({\r\n        ...option,\r\n        value: get(option, keys?.value || 'value'),\r\n        label: get(option, keys?.label || 'label'),\r\n      }));\r\n    }\r\n    setCurrentOptions(transformedOptions);\r\n    setTmpPropOptions(transformedOptions);\r\n\r\n    setValueToOption(\r\n      getValueToOption(\r\n        children as ReactElement,\r\n        options as TdOptionProps[],\r\n        keys,\r\n      ) || {},\r\n    );\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, [options, keys, children, reserveKeyword]);\r\n\r\n  // 同步 value 对应的 options\r\n  useEffect(() => {\r\n    const valueKey = keys?.value || 'value';\r\n    const labelKey = keys?.label || 'label';\r\n\r\n    setSelectedOptions((oldSelectedOptions: SelectOption[]) => {\r\n      const createOptionFromValue = (item: OptionValueType) => {\r\n        if (valueType === 'value') {\r\n          return (\r\n            valueToOption[item as string | number] ||\r\n            oldSelectedOptions.find(\r\n              (option) => get(option, valueKey) === item,\r\n            ) || {\r\n              [valueKey]: item,\r\n              [labelKey]: item,\r\n            }\r\n          );\r\n        }\r\n        if (typeof item === 'object' && item !== null) {\r\n          return item;\r\n        }\r\n        return [];\r\n      };\r\n\r\n      // 多选\r\n      if (Array.isArray(value)) {\r\n        return value.map(createOptionFromValue);\r\n      }\r\n\r\n      // 单选\r\n      if (value !== undefined && value !== null) {\r\n        const option = createOptionFromValue(value);\r\n        return option ? [option] : [];\r\n      }\r\n\r\n      return [];\r\n    });\r\n  }, [value, keys, valueType, valueToOption, setSelectedOptions]);\r\n\r\n  return {\r\n    currentOptions,\r\n    setCurrentOptions,\r\n    tmpPropOptions,\r\n    setTmpPropOptions,\r\n    valueToOption,\r\n    setValueToOption,\r\n    selectedOptions,\r\n    setSelectedOptions,\r\n  };\r\n}\r\n\r\nexport default UseOptions;\r\n","import React, {\r\n  useEffect,\r\n  useMemo,\r\n  KeyboardEvent,\r\n  WheelEvent,\r\n  useRef,\r\n  useCallback,\r\n  Children,\r\n  cloneElement,\r\n  isValidElement,\r\n  useState,\r\n} from 'react';\r\n\r\nimport classNames from 'classnames';\r\nimport { isFunction, get, debounce } from 'lodash-es';\r\nimport { getOffsetTopToContainer } from '../utils/helper';\r\nimport useControlled from '../hooks/useControlled';\r\nimport useConfig from '../hooks/useConfig';\r\nimport forwardRefWithStatics from '../utils/forwardRefWithStatics';\r\nimport { getSelectValueArr, getSelectedOptions } from './utils/helper';\r\n\r\nimport noop from '../utils/noop';\r\nimport FakeArrow from '../common/FakeArrow';\r\nimport Loading from '../loading';\r\nimport SelectInput, {\r\n  SelectInputValue,\r\n  SelectInputValueChangeContext,\r\n} from '../select-input';\r\nimport Option from './Option';\r\nimport OptionGroup from './OptionGroup';\r\nimport PopupContent from './PopupContent';\r\nimport { Tag } from '../tag';\r\nimport {\r\n  TdSelectProps,\r\n  TdOptionProps,\r\n  SelectOption,\r\n  SelectValueChangeTrigger,\r\n  SelectValue,\r\n} from './type';\r\n\r\nimport { StyledProps } from '../common';\r\nimport { selectDefaultProps } from './defaultProps';\r\nimport { PopupVisibleChangeContext, type TdPopupProps } from '../popup';\r\n\r\nimport useOptions, { isSelectOptionGroup } from './hooks/useOptions';\r\nimport composeRefs from '../utils/composeRefs';\r\nimport { parseContentTNode } from '../utils/parentTNode';\r\nimport useDefaultProps from '../hooks/useDefaultProps';\r\n\r\nexport interface SelectProps<T = SelectOption>\r\n  extends TdSelectProps<T>,\r\n  StyledProps {\r\n  // 子节点\r\n  children?: React.ReactNode;\r\n  onMouseEnter?: (event: React.MouseEvent<HTMLDivElement, MouseEvent>) => void;\r\n  onMouseLeave?: (event: React.MouseEvent<HTMLDivElement, MouseEvent>) => void;\r\n}\r\n\r\ntype OptionsType = TdOptionProps[];\r\n\r\nconst Select = forwardRefWithStatics(\r\n  (originalProps: SelectProps, ref: React.Ref<HTMLDivElement>) => {\r\n    const props = useDefaultProps<SelectProps>(\r\n      originalProps,\r\n      selectDefaultProps,\r\n    );\r\n    const {\r\n      readonly,\r\n      borderless,\r\n      autoWidth,\r\n      creatable,\r\n      loadingText = '加载中...',\r\n      max,\r\n      popupProps,\r\n      reserveKeyword,\r\n      className,\r\n      style,\r\n      disabled,\r\n      size,\r\n      multiple,\r\n      placeholder,\r\n      clearable,\r\n      prefixIcon,\r\n      options,\r\n      filterable,\r\n      loading,\r\n      empty,\r\n      valueType,\r\n      keys,\r\n      children,\r\n      collapsedItems,\r\n      minCollapsedNum,\r\n      valueDisplay,\r\n      showArrow,\r\n      inputProps,\r\n      panelBottomContent,\r\n      panelTopContent,\r\n      selectInputProps,\r\n      tagInputProps,\r\n      tagProps,\r\n      scroll,\r\n      suffixIcon,\r\n      label,\r\n      filter,\r\n      onFocus,\r\n      onBlur,\r\n      onClear = noop,\r\n      onCreate,\r\n      onRemove,\r\n      onSearch,\r\n      onEnter,\r\n      onPopupVisibleChange,\r\n    } = props;\r\n\r\n    const [value, onChange] = useControlled(props, 'value', props.onChange);\r\n    const selectInputRef = useRef(null);\r\n    const { classPrefix } = useConfig();\r\n    const { overlayClassName, onScroll, onScrollToBottom, ...restPopupProps } =\r\n      popupProps || {};\r\n    const [isScrolling, toggleIsScrolling] = useState(false);\r\n\r\n    const name = `${classPrefix}-select`; // t-select\r\n\r\n    const [showPopup, setShowPopup] = useControlled(\r\n      props,\r\n      'popupVisible',\r\n      onPopupVisibleChange,\r\n    );\r\n    const [inputValue, onInputChange] = useControlled(\r\n      props,\r\n      'inputValue',\r\n      props.onInputChange,\r\n    );\r\n\r\n    const {\r\n      currentOptions,\r\n      setCurrentOptions,\r\n      tmpPropOptions,\r\n      valueToOption,\r\n      selectedOptions,\r\n    } = useOptions(keys, options, children, valueType, value, reserveKeyword);\r\n\r\n    const selectedLabel = useMemo(() => {\r\n      if (multiple) {\r\n        return selectedOptions.map(\r\n          (selectedOption) =>\r\n            get(selectedOption || {}, keys?.label || 'label') || '',\r\n        );\r\n      }\r\n      return get(selectedOptions[0] || {}, keys?.label || 'label') || undefined;\r\n    }, [selectedOptions, keys, multiple]);\r\n\r\n    const handleShowPopup = (\r\n      visible: boolean,\r\n      ctx: PopupVisibleChangeContext,\r\n    ) => {\r\n      if (disabled) return;\r\n      visible && toggleIsScrolling(false);\r\n      !visible && onInputChange('', { trigger: 'blur' });\r\n      setShowPopup(visible, ctx);\r\n    };\r\n\r\n    // 可以根据触发来源，自由定制标签变化时的筛选器行为\r\n    const onTagChange = (_currentTags: SelectInputValue, context) => {\r\n      const { trigger, index, item, e } = context;\r\n      // backspace\r\n      if (trigger === 'backspace') {\r\n        e.stopPropagation();\r\n\r\n        let closest = -1;\r\n        let len = index;\r\n        while (len >= 0) {\r\n          const option = selectedOptions[len];\r\n          if (!isSelectOptionGroup(option) && !option.disabled) {\r\n            closest = len;\r\n            break;\r\n          }\r\n          len -= 1;\r\n        }\r\n        if (closest < 0) {\r\n          return;\r\n        }\r\n        const values = getSelectValueArr(\r\n          value,\r\n          value[closest],\r\n          true,\r\n          valueType,\r\n          keys,\r\n        );\r\n\r\n        // 处理onChange回调中的selectedOptions参数\r\n        const { currentSelectedOptions } = getSelectedOptions(\r\n          values,\r\n          multiple,\r\n          valueType,\r\n          keys,\r\n          valueToOption,\r\n        );\r\n        onChange(values, {\r\n          e,\r\n          trigger,\r\n          selectedOptions: currentSelectedOptions,\r\n        });\r\n        return;\r\n      }\r\n\r\n      if (trigger === 'tag-remove') {\r\n        e?.stopPropagation?.();\r\n        const values = getSelectValueArr(\r\n          value,\r\n          value[index],\r\n          true,\r\n          valueType,\r\n          keys,\r\n        );\r\n        // 处理onChange回调中的selectedOptions参数\r\n        const { currentSelectedOptions } = getSelectedOptions(\r\n          values,\r\n          multiple,\r\n          valueType,\r\n          keys,\r\n          valueToOption,\r\n        );\r\n\r\n        onChange(values, {\r\n          e,\r\n          trigger,\r\n          selectedOptions: currentSelectedOptions,\r\n        });\r\n        if (isFunction(onRemove)) {\r\n          onRemove({\r\n            value: value[index],\r\n            data: {\r\n              label: item,\r\n              value: value[index],\r\n            },\r\n            e,\r\n          });\r\n        }\r\n      }\r\n    };\r\n\r\n    const onCheckAllChange = (\r\n      checkAll: boolean,\r\n      e: React.MouseEvent<HTMLLIElement>,\r\n    ) => {\r\n      const isDisabledCheckAll = (opt: TdOptionProps) =>\r\n        opt.checkAll && opt.disabled;\r\n      if (\r\n        !multiple ||\r\n        currentOptions.some(\r\n          (opt) => !isSelectOptionGroup(opt) && isDisabledCheckAll(opt),\r\n        )\r\n      ) {\r\n        return;\r\n      }\r\n\r\n      const isSelectableOption = (opt: TdOptionProps) =>\r\n        !opt.checkAll && !opt.disabled;\r\n      const getOptionValue = (option: SelectOption) =>\r\n        valueType === 'object' ? option : option[keys?.value || 'value'];\r\n\r\n      const values = [];\r\n      currentOptions.forEach((option) => {\r\n        if (isSelectOptionGroup(option)) {\r\n          option.children.forEach((item) => {\r\n            if (isSelectableOption(item)) {\r\n              values.push(getOptionValue(item));\r\n            }\r\n          });\r\n        } else if (isSelectableOption(option)) {\r\n          values.push(getOptionValue(option));\r\n        }\r\n      });\r\n\r\n      const { currentSelectedOptions, allSelectedValue } = getSelectedOptions(\r\n        values,\r\n        multiple,\r\n        valueType,\r\n        keys,\r\n        valueToOption,\r\n      );\r\n\r\n      const checkAllValue =\r\n        !checkAll &&\r\n          allSelectedValue.length !== (props.value as Array<SelectOption>)?.length\r\n          ? allSelectedValue\r\n          : [];\r\n\r\n      onChange?.(checkAllValue, {\r\n        e,\r\n        trigger: !checkAll ? 'check' : 'uncheck',\r\n        selectedOptions: currentSelectedOptions,\r\n      });\r\n    };\r\n\r\n    // 选中 Popup 某项\r\n    const handleChange = (\r\n      value:\r\n        | string\r\n        | number\r\n        | Array<string | number | Record<string, string | number>>,\r\n      context: {\r\n        e: React.MouseEvent<HTMLLIElement>;\r\n        trigger: SelectValueChangeTrigger;\r\n        value?: SelectValue;\r\n        label?: string;\r\n      },\r\n    ) => {\r\n      const selectedValue = multiple ? context.value : value;\r\n\r\n      if (multiple) {\r\n        !reserveKeyword &&\r\n          inputValue &&\r\n          onInputChange('', { e: context.e, trigger: 'change' });\r\n      }\r\n      if (creatable && isFunction(onCreate)) {\r\n        if (\r\n          (options as OptionsType).filter(\r\n            (option) => option.value === selectedValue,\r\n          ).length === 0\r\n        ) {\r\n          onCreate(selectedValue as string); // 手动输入 此时为string\r\n        }\r\n      }\r\n      // 处理onChange回调中的selectedOptions参数\r\n      const { currentSelectedOptions, currentOption } = getSelectedOptions(\r\n        value,\r\n        multiple,\r\n        valueType,\r\n        keys,\r\n        valueToOption,\r\n        selectedValue,\r\n      );\r\n      onChange?.(value, {\r\n        e: context.e,\r\n        trigger: context.trigger,\r\n        selectedOptions: currentSelectedOptions,\r\n        option: currentOption,\r\n      });\r\n\r\n      if (multiple && context?.trigger === 'uncheck' && isFunction(onRemove)) {\r\n        const value = context?.value;\r\n        const option = (options as OptionsType).find(\r\n          (option) => option.value === value,\r\n        );\r\n        onRemove({\r\n          value,\r\n          data: option,\r\n          e: context.e,\r\n        });\r\n      }\r\n    };\r\n\r\n    // 处理filter逻辑\r\n    const handleFilter = (value: string) => {\r\n      let filteredOptions: SelectOption[] = [];\r\n      if (filterable && isFunction(onSearch)) {\r\n        return;\r\n      }\r\n      if (!value) {\r\n        setCurrentOptions(tmpPropOptions);\r\n        return;\r\n      }\r\n\r\n      const filterLabels = [];\r\n      const filterMethods = (option: SelectOption) => {\r\n        if (filter && isFunction(filter)) {\r\n          return filter(value, option);\r\n        }\r\n        const upperValue = value.toUpperCase();\r\n        return (option?.label || '').toUpperCase().includes(upperValue);\r\n      };\r\n\r\n      tmpPropOptions?.forEach((option) => {\r\n        if (isSelectOptionGroup(option)) {\r\n          filteredOptions.push({\r\n            ...option,\r\n            children: option.children?.filter((child) => {\r\n              if (filterMethods(child)) {\r\n                filterLabels.push(child.label);\r\n                return true;\r\n              }\r\n              return false;\r\n            }),\r\n          });\r\n        } else if (filterMethods(option)) {\r\n          filterLabels.push(option.label);\r\n          filteredOptions.push(option);\r\n        }\r\n      });\r\n      const isSameLabelOptionExist = filterLabels.includes(value);\r\n      if (creatable && !isSameLabelOptionExist) {\r\n        filteredOptions = filteredOptions.concat([{ label: value, value }]);\r\n      }\r\n      setCurrentOptions(filteredOptions);\r\n    };\r\n\r\n    // 处理输入框逻辑\r\n    const handleInputChange = (\r\n      value: string,\r\n      context: SelectInputValueChangeContext,\r\n    ) => {\r\n      if (context.trigger !== 'clear') {\r\n        onInputChange(value, { e: context.e, trigger: 'input' });\r\n      }\r\n      if (value === undefined) {\r\n        return;\r\n      }\r\n      if (isFunction(onSearch)) {\r\n        onSearch(value, { e: context.e as KeyboardEvent<HTMLDivElement> });\r\n        return;\r\n      }\r\n    };\r\n\r\n    const handleClear = (context) => {\r\n      context.e.stopPropagation();\r\n      if (Array.isArray(value)) {\r\n        onChange([], { ...context, trigger: 'clear', selectedOptions: [] });\r\n      } else {\r\n        onChange(null, { ...context, trigger: 'clear', selectedOptions: [] });\r\n      }\r\n      onClear(context);\r\n    };\r\n\r\n    useEffect(() => {\r\n      if (typeof inputValue !== 'undefined') {\r\n        handleFilter(String(inputValue));\r\n      }\r\n      // eslint-disable-next-line react-hooks/exhaustive-deps\r\n    }, [inputValue, tmpPropOptions]);\r\n\r\n    // 渲染后置图标\r\n    const renderSuffixIcon = () => {\r\n      if (suffixIcon) {\r\n        return suffixIcon;\r\n      }\r\n      if (loading) {\r\n        return (\r\n          <Loading\r\n            className={classNames(\r\n              `${name}__right-icon`,\r\n              `${name}__active-icon`,\r\n            )}\r\n            loading={true}\r\n            size=\"small\"\r\n          />\r\n        );\r\n      }\r\n\r\n      return (\r\n        showArrow && (\r\n          <FakeArrow\r\n            className={`${name}__right-icon`}\r\n            isActive={showPopup}\r\n            disabled={disabled}\r\n          />\r\n        )\r\n      );\r\n    };\r\n\r\n    const getPopupInstance = useCallback(\r\n      () => (selectInputRef as any).current?.getPopupContentElement(),\r\n      [],\r\n    );\r\n\r\n    const childrenWithProps = Children.map(children, (child) => {\r\n      if (isValidElement(child)) {\r\n        const addedProps = { multiple };\r\n        return cloneElement(child, { ...addedProps });\r\n      }\r\n      return child;\r\n    });\r\n\r\n    // 渲染主体内容\r\n    const renderContent = () => {\r\n      const popupContentProps = {\r\n        onChange: handleChange,\r\n        value,\r\n        className,\r\n        size,\r\n        multiple,\r\n        showPopup,\r\n        // popup弹出层内容只会在点击事件之后触发 并且无任何透传参数\r\n        setShowPopup: (show: boolean) => handleShowPopup(show, {}),\r\n        options: currentOptions,\r\n        empty,\r\n        max,\r\n        loadingText,\r\n        loading,\r\n        valueType,\r\n        keys,\r\n        panelBottomContent,\r\n        panelTopContent,\r\n        onCheckAllChange,\r\n        getPopupInstance,\r\n        scroll,\r\n      };\r\n      return (\r\n        <PopupContent {...popupContentProps}>{childrenWithProps}</PopupContent>\r\n      );\r\n    };\r\n\r\n    const renderValueDisplay = () => {\r\n      if (!valueDisplay) {\r\n        if (!multiple) {\r\n          if (typeof selectedLabel !== 'string') {\r\n            return selectedLabel;\r\n          }\r\n          return '';\r\n        }\r\n        return ({ value: val }) =>\r\n          val\r\n            .slice(0, minCollapsedNum ? minCollapsedNum : val.length)\r\n            .map((v: string, key: number) => {\r\n              const filterOption: SelectOption & { disabled?: boolean } =\r\n                options?.find((option) => option.label === v);\r\n              return (\r\n                <Tag\r\n                  key={key}\r\n                  closable={!filterOption?.disabled && !disabled && !readonly}\r\n                  size={size}\r\n                  {...tagProps}\r\n                  onClose={({ e }) => {\r\n                    e.stopPropagation();\r\n                    e?.nativeEvent?.stopImmediatePropagation?.();\r\n                    const values = getSelectValueArr(\r\n                      value,\r\n                      value[key],\r\n                      true,\r\n                      valueType,\r\n                      keys,\r\n                    );\r\n\r\n                    const { currentSelectedOptions } = getSelectedOptions(\r\n                      values,\r\n                      multiple,\r\n                      valueType,\r\n                      keys,\r\n                      valueToOption,\r\n                      value,\r\n                    );\r\n                    onChange(values, {\r\n                      e,\r\n                      selectedOptions: currentSelectedOptions,\r\n                      trigger: 'tag-remove',\r\n                    });\r\n                    tagProps?.onClose?.({ e });\r\n\r\n                    onRemove?.({\r\n                      value: value[key],\r\n                      data: { label: v, value: value[key] },\r\n                      e: e as unknown as React.MouseEvent<\r\n                        HTMLDivElement,\r\n                        MouseEvent\r\n                      >,\r\n                    });\r\n                  }}\r\n                >\r\n                  {v}\r\n                </Tag>\r\n              );\r\n            });\r\n      }\r\n      if (typeof valueDisplay === 'string') {\r\n        return valueDisplay;\r\n      }\r\n      if (multiple) {\r\n        return ({ onClose }) =>\r\n          parseContentTNode(valueDisplay, { value: selectedOptions, onClose });\r\n      }\r\n      return parseContentTNode(valueDisplay, {\r\n        value: selectedLabel,\r\n        onClose: noop,\r\n      });\r\n    };\r\n\r\n    // 将第一个选中的 option 置于列表可见范围的最后一位\r\n    const updateScrollTop = (content: HTMLDivElement) => {\r\n      if (!content || isScrolling) {\r\n        return;\r\n      }\r\n      const firstSelectedNode: HTMLDivElement = content.querySelector(\r\n        `.${classPrefix}-is-selected`,\r\n      );\r\n      if (!multiple && firstSelectedNode) {\r\n        const { paddingBottom } = getComputedStyle(firstSelectedNode);\r\n        const { marginBottom } = getComputedStyle(content);\r\n        const elementBottomHeight =\r\n          parseInt(paddingBottom, 10) + parseInt(marginBottom, 10);\r\n        // 小于0时不需要特殊处理，会被设为0\r\n        const updateValue =\r\n          getOffsetTopToContainer(firstSelectedNode, content) -\r\n          content.offsetTop -\r\n          (content.clientHeight - firstSelectedNode.clientHeight) +\r\n          elementBottomHeight;\r\n\r\n        // 通过 setTimeout 确保组件渲染完成后再设置 scrollTop\r\n        setTimeout(() => {\r\n          // eslint-disable-next-line no-param-reassign\r\n          content.scrollTop = updateValue;\r\n        });\r\n      }\r\n    };\r\n\r\n    const { onMouseEnter, onMouseLeave } = props;\r\n\r\n    const handleEnter = (\r\n      _,\r\n      context: { inputValue: string; e: KeyboardEvent<HTMLDivElement> },\r\n    ) => {\r\n      onEnter?.({ ...context, value });\r\n    };\r\n\r\n    const handleScroll = ({ e }: { e: WheelEvent<HTMLDivElement> }) => {\r\n      toggleIsScrolling(true);\r\n\r\n      onScroll?.({ e });\r\n      if (onScrollToBottom) {\r\n        const debounceOnScrollBottom = debounce(\r\n          (e) => onScrollToBottom({ e }),\r\n          100,\r\n        );\r\n\r\n        const { scrollTop, clientHeight, scrollHeight } =\r\n          e.target as HTMLDivElement;\r\n        if (clientHeight + Math.floor(scrollTop) === scrollHeight) {\r\n          debounceOnScrollBottom(e);\r\n        }\r\n      }\r\n    };\r\n\r\n    return (\r\n      <div\r\n        className={classNames(`${name}__wrap`, className)}\r\n        style={style}\r\n        onMouseEnter={onMouseEnter}\r\n        onMouseLeave={onMouseLeave}\r\n      >\r\n        <SelectInput\r\n          autoWidth={!style?.width && autoWidth}\r\n          ref={composeRefs(ref, selectInputRef)}\r\n          className={name}\r\n          readonly={readonly}\r\n          autofocus={props.autofocus}\r\n          allowInput={filterable || isFunction(filter)}\r\n          multiple={multiple}\r\n          value={selectedLabel}\r\n          options={selectedOptions}\r\n          valueDisplay={renderValueDisplay()}\r\n          clearable={clearable}\r\n          disabled={disabled}\r\n          status={props.status}\r\n          tips={props.tips}\r\n          borderless={borderless}\r\n          label={label}\r\n          suffix={props.suffix}\r\n          prefixIcon={prefixIcon}\r\n          suffixIcon={renderSuffixIcon()}\r\n          panel={renderContent()}\r\n          placeholder={\r\n            !multiple && showPopup && selectedLabel\r\n              ? selectedLabel\r\n              : placeholder || '请选择'\r\n          }\r\n          inputValue={inputValue}\r\n          tagInputProps={{\r\n            size,\r\n            ...tagInputProps,\r\n          }}\r\n          tagProps={{ size, ...tagProps }}\r\n          inputProps={{\r\n            size,\r\n            ...inputProps,\r\n          }}\r\n          minCollapsedNum={minCollapsedNum}\r\n          collapsedItems={collapsedItems}\r\n          updateScrollTop={updateScrollTop}\r\n          popupProps={{\r\n            overlayClassName: [`${name}__dropdown`, overlayClassName] as TdPopupProps['overlayClassName'],\r\n            onScroll: handleScroll,\r\n            ...restPopupProps,\r\n          }}\r\n          popupVisible={showPopup}\r\n          onPopupVisibleChange={handleShowPopup}\r\n          onTagChange={onTagChange}\r\n          onInputChange={handleInputChange}\r\n          onFocus={onFocus}\r\n          onEnter={handleEnter}\r\n          onBlur={(_, context) => {\r\n            onBlur?.({\r\n              value,\r\n              e: context.e as React.FocusEvent<HTMLDivElement>,\r\n            });\r\n          }}\r\n          onClear={handleClear}\r\n          {...selectInputProps}\r\n        />\r\n      </div>\r\n    );\r\n  },\r\n  { Option, OptionGroup },\r\n);\r\n\r\nSelect.displayName = 'Select';\r\n\r\nexport default Select;\r\n"],"names":["isSelectOptionGroup","option","UseOptions","keys","options","children","valueType","value","reserveKeyword","_useState","useState","_useState2","_slicedToArray","valueToOption","setValueToOption","_useState3","_useState4","currentOptions","setCurrentOptions","_useState5","_useState6","tmpPropOptions","setTmpPropOptions","_useState7","_useState8","selectedOptions","setSelectedOptions","useEffect","transformedOptions","arrayChildren","React","Children","toArray","optionChildren","filter","v","type","Option","OptionGroup","isChildrenFilterable","length","handlerOptionElement","isValidElement","_v$props$children","_objectSpread","props","group","label","map","_transformedOptions","get","getValueToOption","valueKey","labelKey","oldSelectedOptions","createOptionFromValue","item","find","_defineProperty","_typeof","Array","isArray","undefined","Select","forwardRefWithStatics","originalProps","ref","useDefaultProps","selectDefaultProps","readonly","borderless","autoWidth","creatable","_props$loadingText","loadingText","max","popupProps","className","style","disabled","size","multiple","placeholder","clearable","prefixIcon","filterable","loading","empty","collapsedItems","minCollapsedNum","valueDisplay","showArrow","inputProps","panelBottomContent","panelTopContent","selectInputProps","tagInputProps","tagProps","scroll","suffixIcon","onFocus","onBlur","_props$onClear","onClear","noop","onCreate","onRemove","onSearch","onEnter","onPopupVisibleChange","_useControlled","useControlled","onChange","_useControlled2","selectInputRef","useRef","_useConfig","useConfig","classPrefix","_ref","overlayClassName","onScroll","onScrollToBottom","restPopupProps","_objectWithoutProperties","_excluded","isScrolling","toggleIsScrolling","name","concat","_useControlled3","_useControlled4","showPopup","setShowPopup","_useControlled5","onInputChange","_useControlled6","inputValue","_useOptions","useOptions","selectedLabel","useMemo","selectedOption","handleShowPopup","visible","ctx","trigger","onTagChange","_currentTags","context","index","e","stopPropagation","closest","len","values","getSelectValueArr","_getSelectedOptions","getSelectedOptions","currentSelectedOptions","_e$stopPropagation","call","_getSelectedOptions2","isFunction","data","onCheckAllChange","checkAll","_props$value","isDisabledCheckAll","opt","some","isSelectableOption","getOptionValue","forEach","push","_getSelectedOptions3","allSelectedValue","checkAllValue","handleChange","selectedValue","_getSelectedOptions4","currentOption","handleFilter","filteredOptions","filterLabels","filterMethods","upperValue","toUpperCase","includes","_option$children","child","isSameLabelOptionExist","handleInputChange","handleClear","String","renderSuffixIcon","createElement","Loading","classNames","FakeArrow","isActive","getPopupInstance","useCallback","_current","current","getPopupContentElement","childrenWithProps","addedProps","cloneElement","renderContent","popupContentProps","show","PopupContent","renderValueDisplay","_ref2","val","slice","key","filterOption","Tag","_extends","closable","onClose","_ref3","_e$nativeEvent","_e$nativeEvent$stopIm","_tagProps$onClose","nativeEvent","stopImmediatePropagation","_getSelectedOptions5","_ref4","parseContentTNode","updateScrollTop","content","firstSelectedNode","querySelector","_getComputedStyle","getComputedStyle","paddingBottom","_getComputedStyle2","marginBottom","elementBottomHeight","parseInt","updateValue","getOffsetTopToContainer","offsetTop","clientHeight","setTimeout","scrollTop","onMouseEnter","onMouseLeave","handleEnter","_","handleScroll","_ref5","debounceOnScrollBottom","debounce","_ref6","target","scrollHeight","Math","floor","SelectInput","width","composeRefs","autofocus","allowInput","status","tips","suffix","panel","popupVisible","displayName"],"mappings":"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"}