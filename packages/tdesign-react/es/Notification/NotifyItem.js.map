{"version":3,"file":"NotifyItem.js","sources":["../../../components/Notification/NotifyItem.tsx"],"sourcesContent":["import React, { useLayoutEffect, useRef, useState } from \"react\";\nimport { XCircle, CheckCircle, AlertCircle, Info } from \"lucide-react\";\nimport useConfig from \"../hooks/useConfig\";\n\nconst NotificationItem: React.FC<{\n  id: string;\n  message: string;\n  type: string;\n  heights: { toastId: string; height: number }[];\n  gap: number;\n  setHeights: React.Dispatch<\n    React.SetStateAction<\n      { toastId: string; height: number; message: string; type: string }[]\n    >\n  >;\n  isRemoved: boolean;\n  isExpanded: boolean;\n  title: string\n}> = ({\n  message,\n  type,\n  heights,\n  setHeights,\n  id,\n  gap,\n  isExpanded,\n  isRemoved,\n  title\n}) => {\n    const [initialHeight, setInitialHeight] = useState(0);\n    const [isMounted, setIsMounted] = useState(false);\n    const nofityItem = useRef<HTMLDivElement>(null);\n    const { classPrefix: prefix } = useConfig();\n    React.useEffect(() => {\n      setIsMounted(true);\n    }, []);\n\n    React.useEffect(() => {\n      const notifyNode = nofityItem.current;\n      if (notifyNode) {\n        const height = notifyNode.getBoundingClientRect().height;\n        setInitialHeight(height);\n        setHeights(h => {\n          // 如果不存在，则添加\n          return [{ toastId: id, height, message, type }, ...h];\n        });\n        return () => {\n          setHeights(h => h.filter(h => h.toastId !== id));\n        };\n      }\n    }, [setHeights, id]);\n\n    useLayoutEffect(() => {\n      if (!isMounted) return;\n      const notifyNode = nofityItem.current;\n      if (notifyNode) {\n        const originalHeight = notifyNode.style.height;\n        notifyNode.style.height = \"auto\";\n        const newHeight = notifyNode.getBoundingClientRect().height;\n        notifyNode.style.height = originalHeight;\n        setInitialHeight(newHeight);\n        setHeights(heights => {\n          const isExist = heights.some(h => h.toastId === id);\n          if (isExist) {\n            // 如果存在，则更新高度\n            return heights.map(h =>\n              h.toastId === id ? { ...h, height: newHeight, message, type } : h\n            );\n          }\n          // 如果不存在，则添加\n          return [{ toastId: id, height: newHeight, message, type }, ...heights];\n        });\n      }\n    }, [isMounted, initialHeight, setHeights, id, message, type]);\n    const heightIndex = React.useMemo(() => {\n      return heights.findIndex(h => h.toastId === id);\n    }, [heights, id]);\n    const toastHeightBefore = React.useMemo(() => {\n      return heights.reduce((acc, h, reduceIndex) => {\n        if (reduceIndex < heightIndex) {\n          return acc + h.height;\n        }\n        return acc;\n      }, 0);\n    }, [initialHeight, heightIndex, heights]);\n\n    const offset = React.useMemo(\n      () => heightIndex * gap + toastHeightBefore,\n      [toastHeightBefore, heightIndex]\n    );\n\n    return (\n      <div\n\n        className={`${prefix}-notify__item`}\n        ref={nofityItem}\n        style={\n          {\n            position: \"absolute\",\n            height: isExpanded ? `auto` : `var(--front-toast-height)`,\n            width: `var(--toast-width)`,\n            \"--offset\": offset + \"px\",\n            \"--index\": heightIndex,\n            \"--gap\": gap + \"px\",\n            \"--z-index\": heights.length - heightIndex\n          } as React.CSSProperties\n        }\n        data-toast\n        data-mounted={isMounted}\n        data-expanded={isExpanded}\n        data-removed={isRemoved}\n        data-front={heightIndex === 0}\n      >\n        <div className={`${prefix}-notify__content`}>\n\n          <div className={`${prefix}-notify__header`}>\n            <div className={`${prefix}-notify__icon`} >\n              {type === \"success\" && <CheckCircle className=\"t-icon t-is-success\" />}\n              {type === \"error\" && <XCircle className=\"t-icon t-is-error\" />}\n              {type === \"info\" && <Info className=\"t-icon t-is-info\" />}\n              {type === \"warning\" && <AlertCircle className=\"t-icon t-is-warning\" />}\n              {type === \"default\" && <Info className=\"t-icon t-is-info\" />}\n            </div>\n\n            <div className={`${prefix}-notify__title`}>{title}</div>\n          </div>\n\n        </div>\n        <p className={`${prefix}-notify__detail`} style={{ opacity: heightIndex === 0 || isExpanded ? 1 : 0, transition: `opacity 400ms` }}>{message}</p>\n      </div>\n    );\n  };\n\nexport default NotificationItem;\n"],"names":["NotificationItem","message","_ref","type","heights","setHeights","id","gap","isExpanded","isRemoved","title","_useState","useState","_useState2","_slicedToArray","initialHeight","setInitialHeight","_useState3","_useState4","isMounted","setIsMounted","nofityItem","useRef","_useConfig","useConfig","prefix","classPrefix","React","useEffect","notifyNode","current","height","getBoundingClientRect","h","toastId","concat","_toConsumableArray","filter","useLayoutEffect","originalHeight","style","newHeight","isExist","some","map","_objectSpread","heightIndex","useMemo","findIndex","toastHeightBefore","reduce","acc","reduceIndex","offset","createElement","className","ref","position","width","length","CheckCircle","XCircle","Info","AlertCircle","opacity","transition"],"mappings":"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"}