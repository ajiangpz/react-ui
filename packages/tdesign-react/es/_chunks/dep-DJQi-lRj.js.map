{"version":3,"file":"dep-DJQi-lRj.js","sources":["../../../components/hooks/useAttach.ts","../../../components/hooks/useSetState.ts","../../../components/hooks/useMouseEvent.ts","../../../components/utils/getScrollbarWidth.ts"],"sourcesContent":["import { useMemo } from 'react';\nimport { AttachNode } from '../components/common';\nimport useConfig from './useConfig';\n\nconst defaultAttach = 'body';\n/**\n * useAttach\n *\n * 挂载节点 优先级:\n *\n * props attach -> globalConfig.attach.component -> globalConfig.attach -> default = 'body'\n */\nconst useAttach = (name: string, attach: AttachNode | undefined) => {\n  const globalConfig = useConfig();\n\n  const attachVal = useMemo<AttachNode>(\n    () =>\n      attach ||\n      globalConfig?.attach?.[name] ||\n      globalConfig?.attach ||\n      defaultAttach,\n    [name, attach, globalConfig?.attach],\n  );\n\n  return attachVal;\n};\n\nexport default useAttach;\n","import { useCallback, useState } from 'react';\n\nconst isFunction = (arg: unknown) => typeof arg === 'function';\n\n/**\n * 管理 object 类型 state 的 Hooks，用法与 class 组件的 this.setState 基本一致。\n * @param initialState\n * @returns [state, setMergeState]\n */\nconst useSetState = <T extends object>(\n  initialState: T = {} as T,\n): [T, (patch: Partial<T> | ((prevState: T) => Partial<T>)) => void] => {\n  const [state, setState] = useState<T>(initialState);\n\n  const setMergeState = useCallback((patch: Function | Object) => {\n    setState((prevState) => ({\n      ...prevState,\n      ...(isFunction(patch) ? patch(prevState) : patch),\n    }));\n  }, []);\n\n  return [state, setMergeState];\n};\n\nexport default useSetState;\n","import { useEffect, useRef } from 'react';\n\nexport type MouseEventLike =\n  | MouseEvent\n  | React.MouseEvent\n  | TouchEvent\n  | React.TouchEvent;\nexport type MouseCallback = MouseEvent | React.MouseEvent | Touch | React.Touch;\n\n/**\n * 鼠标相对当前元素的坐标\n */\nexport interface MouseCoordinate {\n  x: number;\n  y: number;\n}\nexport interface MouseContext {\n  coordinate: MouseCoordinate;\n}\n\ntype MouseEventOptions = {\n  enabled?: boolean;\n  enableTouch?: boolean; // 支持触摸事件\n  onDown?: (e: MouseCallback, ctx: MouseContext) => void;\n  onMove?: (e: MouseCallback, ctx: MouseContext) => void;\n  onUp?: (e: MouseCallback, ctx: MouseContext) => void;\n  onEnter?: (e: MouseCallback, ctx: MouseContext) => void;\n  onLeave?: (e: MouseCallback, ctx: MouseContext) => void;\n};\n\nconst useMouseEvent = (\n  elementRef: React.RefObject<HTMLElement | null>,\n  options: MouseEventOptions,\n) => {\n  const { enabled = true, enableTouch = true } = options;\n  const isMovingRef = useRef(false);\n\n  const normalizeEvent = (e: MouseEventLike) => {\n    if (!enableTouch) {\n      return e as MouseEvent;\n    }\n    if ('touches' in e && e.touches.length > 0) {\n      return e.touches[0];\n    }\n    if ('changedTouches' in e && e.changedTouches.length > 0) {\n      return e.changedTouches[0];\n    }\n    if ('clientX' in e && 'clientY' in e) {\n      return e as MouseEvent;\n    }\n    return undefined;\n  };\n\n  const getCoordinate = (event: MouseCallback) => {\n    const rect = elementRef?.current?.getBoundingClientRect();\n    if (!rect) {\n      return { x: 0, y: 0 };\n    }\n    const { clientX, clientY } = event;\n    const left = clientX - rect.left;\n    const top = clientY - rect.top;\n    return {\n      x: Math.min(Math.max(0, left), rect.width),\n      y: Math.min(Math.max(0, top), rect.height),\n    };\n  };\n\n  const emitMouseChange = (\n    e: MouseEventLike,\n    handler?: (e: MouseCallback, ctx: MouseContext) => void,\n  ) => {\n    if (!handler) return;\n    const event = normalizeEvent(e);\n    if (event !== undefined) {\n      const coordinate = getCoordinate(event);\n      handler(event, { coordinate });\n    }\n  };\n\n  const handleMouseMove = (e: MouseEventLike) => {\n    if (!isMovingRef.current) return;\n    e.preventDefault();\n    emitMouseChange(e, options.onMove);\n  };\n\n  const handleMouseUp = (e: MouseEventLike) => {\n    if (!isMovingRef.current) return;\n    isMovingRef.current = false;\n    emitMouseChange(e, options.onUp);\n    document.removeEventListener('mouseup', handleMouseUp);\n    document.removeEventListener('mousemove', handleMouseMove);\n    document.removeEventListener('touchend', handleMouseUp);\n    document.removeEventListener('touchmove', handleMouseMove);\n  };\n\n  const handleMouseDown = (e: MouseEventLike) => {\n    isMovingRef.current = true;\n    emitMouseChange(e, options.onDown);\n    document.addEventListener('mouseup', handleMouseUp);\n    document.addEventListener('mousemove', handleMouseMove);\n    if (!enableTouch) return;\n    document.addEventListener('touchend', handleMouseUp);\n    document.addEventListener('touchmove', handleMouseMove, { passive: false });\n  };\n\n  const handleMouseEnter = (e: MouseEventLike) => {\n    emitMouseChange(e, options.onEnter);\n  };\n\n  const handleMouseLeave = (e: MouseEventLike) => {\n    emitMouseChange(e, options.onLeave);\n  };\n\n  useEffect(() => {\n    const el = elementRef.current;\n    if (!el || !enabled) return;\n\n    // 基本上只要开启了鼠标事件，就会用到这三个\n    // 有的组件虽然只需要 mousemove 的回调结果，但也需要 mousedown 和 mouseup 来控制状态\n    el.addEventListener('mousedown', handleMouseDown);\n    el.addEventListener('mousemove', handleMouseMove);\n    el.addEventListener('mouseup', handleMouseUp);\n    // 下面这两个一般是为了处理 hover 状态，可选性监听\n    options.onEnter && el.addEventListener('mouseenter', handleMouseEnter);\n    options.onLeave && el.addEventListener('mouseleave', handleMouseLeave);\n\n    if (!enableTouch) return;\n    el.addEventListener('touchstart', handleMouseDown, { passive: false });\n    el.addEventListener('touchend', handleMouseUp);\n\n    return () => {\n      el.removeEventListener('mousedown', handleMouseDown);\n      el.removeEventListener('mouseenter', handleMouseDown);\n      el.removeEventListener('mouseleave', handleMouseLeave);\n      el.removeEventListener('mousemove', handleMouseMove);\n      el.removeEventListener('mouseup', handleMouseUp);\n      el.removeEventListener('touchstart', handleMouseDown);\n      el.removeEventListener('touchend', handleMouseUp);\n    };\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [elementRef.current, options, enabled]);\n\n  return {\n    isMoving: isMovingRef.current,\n  };\n};\n\nexport default useMouseEvent;\n","/**\n * @description: Calculate scroll bar width\n * @param container  Container used to calculate scrollbar width\n * @default container: document.body\n */\nexport function getScrollbarWidth(container: HTMLElement = document.body) {\n  if (container === document.body) {\n    return window.innerWidth - document.documentElement.clientWidth;\n  }\n  return container.offsetWidth - container.clientWidth;\n}\n"],"names":["defaultAttach","useAttach","name","attach","globalConfig","useConfig","attachVal","useMemo","_globalConfig$attach","isFunction","arg","useSetState","initialState","arguments","length","undefined","_useState","useState","_useState2","_slicedToArray","state","setState","setMergeState","useCallback","patch","prevState","_objectSpread","useMouseEvent","elementRef","options","_options$enabled","enabled","_options$enableTouch","enableTouch","isMovingRef","useRef","normalizeEvent","e","touches","changedTouches","getCoordinate","event","_elementRef$current","rect","current","getBoundingClientRect","x","y","clientX","clientY","left","top","Math","min","max","width","height","emitMouseChange","handler","coordinate","handleMouseMove","preventDefault","onMove","handleMouseUp","onUp","document","removeEventListener","handleMouseDown","onDown","addEventListener","passive","handleMouseEnter","onEnter","handleMouseLeave","onLeave","useEffect","el","isMoving","getScrollbarWidth","container","body","window","innerWidth","documentElement","clientWidth","offsetWidth"],"mappings":"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"}